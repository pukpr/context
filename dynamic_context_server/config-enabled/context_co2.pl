:- module(context_co2, [
				hyperbolic/3,
				% exp_lag/3,
			        log_scale/4,
			        diffusive/3,
			        diffu/3,
			        sine_wave/5
			    ]).

/** <module> CO2 adjustment model
    * From
    *
*/

:- use_module(context_math).

:- context:register(context_co2:navigate).
:- context:register(context_co2:plot).

rms([],_,N,N, Result,Result).
rms(_,[],N,N, Result,Result).
rms([A|AA],[B|BB],N, L, Val,Result) :-
   (   B > 0.0 ->
      Sum is Val + (A-B)^2,
      Length is N + 1
   ;
      Sum = Val,
      Length = N
   ),
   rms(AA,BB,Length, L, Sum,Result).

rms(A,B,Result) :-
   rms(A,B,0,N,0,Sq),
   Result is sqrt(Sq/N), !.
/*
exp_lag(Mean, X, Y) :-
    Y = (exp(-X/Mean)+exp(-(X+1.0)/Mean))/2.
    % Y = 1.0/Mean * (exp(-X/Mean)+exp(-(X+1.0)/Mean))/2.
*/
log_scale(T0, Sens, X, Y) :-
    Y is Sens*log(X/T0).

hyperbolic(Median, X, Y) :-
    Y is Median/(Median+X)^2.

evaluate_diffusive(Median, X, Y) :-
    A is sqrt(Median/X),
    Y is A/2/X/(A+1)^2.

sine_wave(Theta, F, Amp, X, Y) :-
    Y is Amp*sin(X*F+Theta).

diffusive(Median, X, Y) :-
    (	X = 0 ->
        Y is 1/(1+sqrt(Median/1))
    ;
        X1 is X + 1,
        evaluate_diffusive(Median, X, Y0),
	evaluate_diffusive(Median, X1, Y1),
	Y is (Y0+Y1)/2
    ).

diffu(Median, X, Y) :-
   Y is (1/(1+sqrt(X/Median))+1/(1+sqrt((X+1)/Median)))/2.


%%   navigate(+Request)
%
%    Dynamic page to shock model
navigate(Request) :-
   %collect_unit_options(time, Tunits),

   reply_html_page(cliopatria(default),
                   [title('CO2 emissions model'),
	           script([type('text/javascript'),src('/html/js/submit.js')], [])
                   ],
                   [\(con_text:table_with_iframe_target(
                                    Request,
		     [
                      h1('Plot CO2 emissions'),
                      form([action(plot), target(target_iframe)],
			 [
			  % select([name('t_units')], Tunits),
			  input([type('text'),
				 name('t0'),
				 value('0.4')]), i(' <= base T'),
			  br([]),
			  input([type('text'),
				 name('sensitivity'),
				 value('3.0')]), i(' <= sensitivity'),
			  br([]),
			  \(con_text:radio_toggles(
					 'evaluate',
					 [['CO2', 'co2'],
                                          ['Carbon', 'carbon'],
					  ['Temperature', 'temperature']
                                         ])),
                          br([]),
			  input([type('submit'), name(kind), value('plot'),
                                 onclick('subm(this.form,"target_iframe");')]),
			  input([type('submit'), name(kind), value('table'),
                                 onclick('subm(this.form,"render");')])
			 ]
                          ),

                      br([]),
		      \(con_text:render_iframe(render))
                     ]
						       ))
     ]
		  ).

/*
production([1,2,3]).
shocks([1,2,3]).
*/

/*
%%   plot(+Request)
%
%    Plot the shock model profile
plot(Request) :-
    http_parameters(Request, [kind(table, []),
			      sensitivity(_Sensitivity, [number]),
                              t0(_TUnits, []),
                              evaluate(_Table, [])]),
    Time range [0, 200]/1,
    shocks(Shocks),
    interpolate(Time, Shocks, Sh),
    Date mapdot 1850 .+ Time,
    Data tuple Date + Sh,

    reply_html_page([title('CO2'),
                     \(con_text:style)],
                    [
		     \(context_graphing:dygraph_native(lin, [date, rate],
						       ['Date', year], ['Rate', fraction],
						       'extraction rate', Data))
                    ]
		  ).

*/

plot(Request) :-
    http_parameters(Request, [kind(Kind, []),
			      sensitivity(Sensitivity, [number]),
                              t0(T0, [number]),
                              evaluate(Characteristic, [default(shocked)])]),

    carbon_emissions(Raw),
    [Year, Carbon, _,_,_,_,_,_]  split Raw,
    Sens is Sensitivity/log(2),

    co2_atm(Mauna_Loa),
    [_Year_Short, CO2_ML] split Mauna_Loa,
    CO2_Empty range [1751, 1957]/1,
    Zeros_CO2 mapdot 0.0 ~> CO2_Empty,
    CO2_Mauna_Loa cat [Zeros_CO2, CO2_ML],
    CO2_Data shrink CO2_Mauna_Loa/Year,

    best(BEST),
    [_, T_BEST] split BEST,
    BEST_Empty range [1751,1799]/1,
    Zeros_BEST mapdot 0.0 ~> BEST_Empty,
    Temperature_BEST cat [Zeros_BEST, T_BEST],
    Temperature_Data shrink Temperature_BEST/Year,

    Timeline range [0,1000]/1,
    Time shrink Timeline/Year,
    % H mapdot diffusive(13) ~> Time,
    H mapdot diffu(36.8) ~> Time,
    % H mapdot diffu(17) ~> Time,
    % H mapdot exp_lag(45.3) ~> Time,
    (
       Characteristic  = co2 ->
         Scale is 1.0/2120,  % PPM / million tons
         CO2_Equivalent mapdot Scale .* Carbon,
         CO2 convolve CO2_Equivalent*H,
         %  Int mapdot 1.0 ~> CO2,
         % CO2_Int accumulate CO2,
         % CO2_Total mapdot 294 .+ CO2_Int,
         CO2_Total mapdot 294.0 .+ CO2,
	 Data tuple Year + CO2_Total + CO2_Data,
         rms(CO2_Total, CO2_Data, RMS),
         Heading = ['Year', 'CO2', 'Data'],
         YUnits = ' PPM'
    ;
       Characteristic = carbon  ->
	 Data tuple Year + Carbon,
         Heading = ['Year', 'Carbon'],
         YUnits = ' million metric tons',
         RMS = -999.99
    ;
       Characteristic = temperature  ->
         Scale is 1.0/2120,  % PPM / million tons
         CO2_Equivalent mapdot Scale .* Carbon,
         CO2 convolve CO2_Equivalent*H,
         CO2_Total mapdot 294 .+ CO2,
         Temperature mapdot log_scale(294,Sens) ~> CO2_Total,
         % T_Slice shrink Temperature/Year,
         % Noise mapdot sine_wave(2.2,0.1,0.25) ~> Year,
         % T mapdot Noise + T_Slice,
         T_Data mapdot T0 .+ Temperature_Data,
	 Data tuple Year + Temperature + T_Data,
         rms(CO2_Total, CO2_Data, RMS),
         Heading = ['Year', 'T from CO2', 'BEST'],
         YUnits = ' C'

    ),
    X = 'Date',
    XUnits = ' year',
    (	Kind = plot ->
    reply_html_page([title(Characteristic),
                     \(con_text:style)],
                    [
		     \(context_graphing:dygraph_native(lin,
						       Heading,
						       [X,XUnits], ['Amount', YUnits],
						       Characteristic, Data)),
		     i('RMS error = '), b('~3f ' - RMS), i('PPM')
                    ]
		  )
    ;
      reply_html_page([title(Characteristic),
                       \(con_text:style)],
                      [
                       \(con_text:table_multiple_entries(
                                      [['Year', Characteristic, 'Data']],
                                      Data
                                                        ))
                      ]
                     )

    ).


% http://cdiac.ornl.gov/ftp/ndp030/global.1751_2009.ems

carbon_emissions([
[1751,    3,      0,      0,      3,      0,      0, _   ],
[1752,    3,      0,      0,      3,      0,      0, _   ],
[1753,    3,      0,      0,      3,      0,      0, _],
[1754,    3,      0,      0,      3,      0,      0, _],
[1755,    3,      0,      0,      3,      0,      0, _],
[1756,    3,      0,      0,      3,      0,      0, _   ],
[1757,    3,      0,      0,      3,      0,      0, _   ],
[1758,    3,      0,      0,      3,      0,      0, _   ],
[1759,    3,      0,      0,      3,      0,      0, _   ],
[1760,    3,      0,      0,      3,      0,      0, _   ],
[1761,    3,      0,      0,      3,      0,      0, _   ],
[1762,    3,      0,      0,      3,      0,      0, _   ],
[1763,    3,      0,      0,      3,      0,      0, _   ],
[1764,    3,      0,      0,      3,      0,      0, _   ],
[1765,    3,      0,      0,      3,      0,      0, _   ],
[1766,    3,      0,      0,      3,      0,      0, _   ],
[1767,    3,      0,      0,      3,      0,      0, _   ],
[1768,    3,      0,      0,      3,      0,      0, _   ],
[1769,    3,      0,      0,      3,      0,      0, _   ],
[1770,    3,      0,      0,      3,      0,      0, _   ],
[1771,    4,      0,      0,      4,      0,      0, _   ],
[1772,    4,      0,      0,      4,      0,      0, _   ],
[1773,    4,      0,      0,      4,      0,      0, _   ],
[1774,    4,      0,      0,      4,      0,      0, _   ],
[1775,    4,      0,      0,      4,      0,      0, _   ],
[1776,    4,      0,      0,      4,      0,      0, _   ],
[1777,    4,      0,      0,      4,      0,      0, _   ],
[1778,    4,      0,      0,      4,      0,      0, _   ],
[1779,    4,      0,      0,      4,      0,      0, _   ],
[1780,    4,      0,      0,      4,      0,      0, _   ],
[1781,    5,      0,      0,      5,      0,      0, _   ],
[1782,    5,      0,      0,      5,      0,      0, _   ],
[1783,    5,      0,      0,      5,      0,      0, _   ],
[1784,    5,      0,      0,      5,      0,      0, _   ],
[1785,    5,      0,      0,      5,      0,      0, _   ],
[1786,    5,      0,      0,      5,      0,      0, _   ],
[1787,    5,      0,      0,      5,      0,      0, _   ],
[1788,    5,      0,      0,      5,      0,      0, _   ],
[1789,    5,      0,      0,      5,      0,      0, _   ],
[1790,    5,      0,      0,      5,      0,      0, _   ],
[1791,    6,      0,      0,      6,      0,      0, _   ],
[1792,    6,      0,      0,      6,      0,      0, _   ],
[1793,    6,      0,      0,      6,      0,      0, _   ],
[1794,    6,      0,      0,      6,      0,      0, _   ],
[1795,    6,      0,      0,      6,      0,      0, _   ],
[1796,    6,      0,      0,      6,      0,      0, _   ],
[1797,    7,      0,      0,      7,      0,      0, _   ],
[1798,    7,      0,      0,      7,      0,      0, _   ],
[1799,    7,      0,      0,      7,      0,      0, _   ],
[1800,    8,      0,      0,      8,      0,      0, _   ],
[1801,    8,      0,      0,      8,      0,      0, _   ],
[1802,   10,      0,      0,     10,      0,      0, _   ],
[1803,    9,      0,      0,      9,      0,      0, _   ],
[1804,    9,      0,      0,      9,      0,      0, _   ],
[1805,    9,      0,      0,      9,      0,      0, _   ],
[1806,   10,      0,      0,     10,      0,      0, _   ],
[1807,   10,      0,      0,     10,      0,      0, _   ],
[1808,   10,      0,      0,     10,      0,      0, _   ],
[1809,   10,      0,      0,     10,      0,      0, _   ],
[1810,   10,      0,      0,     10,      0,      0, _   ],
[1811,   11,      0,      0,     11,      0,      0, _   ],
[1812,   11,      0,      0,     11,      0,      0, _   ],
[1813,   11,      0,      0,     11,      0,      0, _   ],
[1814,   11,      0,      0,     11,      0,      0, _   ],
[1815,   12,      0,      0,     12,      0,      0, _   ],
[1816,   13,      0,      0,     13,      0,      0, _   ],
[1817,   14,      0,      0,     14,      0,      0, _   ],
[1818,   14,      0,      0,     14,      0,      0, _   ],
[1819,   14,      0,      0,     14,      0,      0, _   ],
[1820,   14,      0,      0,     14,      0,      0, _   ],
[1821,   14,      0,      0,     14,      0,      0, _   ],
[1822,   15,      0,      0,     15,      0,      0, _   ],
[1823,   16,      0,      0,     16,      0,      0, _   ],
[1824,   16,      0,      0,     16,      0,      0, _   ],
[1825,   17,      0,      0,     17,      0,      0, _   ],
[1826,   17,      0,      0,     17,      0,      0, _   ],
[1827,   18,      0,      0,     18,      0,      0, _   ],
[1828,   18,      0,      0,     18,      0,      0, _   ],
[1829,   18,      0,      0,     18,      0,      0, _   ],
[1830,   24,      0,      0,     24,      0,      0, _   ],
[1831,   23,      0,      0,     23,      0,      0, _   ],
[1832,   23,      0,      0,     23,      0,      0, _   ],
[1833,   24,      0,      0,     24,      0,      0, _   ],
[1834,   24,      0,      0,     24,      0,      0, _   ],
[1835,   25,      0,      0,     25,      0,      0, _   ],
[1836,   29,      0,      0,     29,      0,      0, _   ],
[1837,   29,      0,      0,     29,      0,      0, _   ],
[1838,   30,      0,      0,     30,      0,      0, _   ],
[1839,   31,      0,      0,     31,      0,      0, _   ],
[1840,   33,      0,      0,     33,      0,      0, _   ],
[1841,   34,      0,      0,     34,      0,      0, _   ],
[1842,   36,      0,      0,     36,      0,      0, _   ],
[1843,   37,      0,      0,     37,      0,      0, _   ],
[1844,   39,      0,      0,     39,      0,      0, _   ],
[1845,   43,      0,      0,     43,      0,      0, _   ],
[1846,   43,      0,      0,     43,      0,      0, _   ],
[1847,   46,      0,      0,     46,      0,      0, _   ],
[1848,   47,      0,      0,     47,      0,      0, _   ],
[1849,   50,      0,      0,     50,      0,      0, _   ],
[1850,   54,      0,      0,     54,      0,      0, _   ],
[1851,   54,      0,      0,     54,      0,      0, _   ],
[1852,   57,      0,      0,     57,      0,      0, _   ],
[1853,   59,      0,      0,     59,      0,      0, _   ],
[1854,   69,      0,      0,     69,      0,      0, _   ],
[1855,   71,      0,      0,     71,      0,      0, _   ],
[1856,   76,      0,      0,     76,      0,      0, _   ],
[1857,   77,      0,      0,     77,      0,      0, _   ],
[1858,   78,      0,      0,     78,      0,      0, _   ],
[1859,   83,      0,      0,     83,      0,      0, _   ],
[1860,   91,      0,      0,     91,      0,      0, _   ],
[1861,   95,      0,      0,     95,      0,      0, _   ],
[1862,   97,      0,      0,     96,      0,      0, _   ],
[1863,  104,      0,      0,    103,      0,      0, _   ],
[1864,  112,      0,      0,    112,      0,      0, _   ],
[1865,  119,      0,      0,    119,      0,      0, _   ],
[1866,  122,      0,      0,    122,      0,      0, _   ],
[1867,  130,      0,      0,    130,      0,      0, _   ],
[1868,  135,      0,      0,    134,      0,      0, _   ],
[1869,  142,      0,      0,    142,      0,      0, _   ],
[1870,  147,      0,      1,    146,      0,      0, _   ],
[1871,  156,      0,      1,    156,      0,      0, _   ],
[1872,  173,      0,      1,    173,      0,      0, _   ],
[1873,  184,      0,      1,    183,      0,      0, _   ],
[1874,  174,      0,      1,    173,      0,      0, _   ],
[1875,  188,      0,      1,    187,      0,      0, _   ],
[1876,  191,      0,      1,    190,      0,      0, _   ],
[1877,  194,      0,      2,    192,      0,      0, _   ],
[1878,  196,      0,      2,    194,      0,      0, _   ],
[1879,  210,      0,      3,    207,      0,      0, _   ],
[1880,  236,      0,      3,    233,      0,      0, _   ],
[1881,  243,      0,      4,    239,      0,      0, _   ],
[1882,  256,      0,      4,    252,      0,      0, _   ],
[1883,  272,      0,      3,    269,      0,      0, _   ],
[1884,  275,      0,      4,    271,      0,      0, _   ],
[1885,  277,      1,      4,    273,      0,      0, _   ],
[1886,  281,      2,      5,    275,      0,      0, _   ],
[1887,  295,      3,      5,    287,      0,      0, _   ],
[1888,  327,      5,      5,    317,      0,      0, _   ],
[1889,  327,      3,      6,    318,      0,      0, _   ],
[1890,  356,      3,      8,    345,      0,      0, _   ],
[1891,  372,      2,      9,    360,      0,      0, _   ],
[1892,  374,      2,      9,    363,      0,      0, _   ],
[1893,  370,      2,     10,    358,      0,      0, _   ],
[1894,  383,      2,      9,    372,      0,      0, _   ],
[1895,  406,      2,     11,    393,      0,      0, _   ],
[1896,  419,      2,     12,    405,      0,      0, _   ],
[1897,  440,      2,     13,    425,      0,      0, _   ],
[1898,  465,      2,     13,    449,      0,      0, _   ],
[1899,  507,      3,     14,    491,      0,      0, _   ],
[1900,  534,      3,     16,    515,      0,      0, _   ],
[1901,  552,      4,     18,    531,      0,      0, _   ],
[1902,  566,      4,     19,    543,      0,      0, _   ],
[1903,  617,      4,     20,    593,      0,      0, _   ],
[1904,  624,      4,     23,    597,      0,      0, _   ],
[1905,  663,      5,     23,    636,      0,      0, _   ],
[1906,  707,      5,     23,    680,      0,      0, _   ],
[1907,  784,      5,     28,    750,      0,      0, _   ],
[1908,  750,      5,     30,    714,      0,      0, _   ],
[1909,  785,      6,     32,    747,      0,      0, _   ],
[1910,  819,      7,     34,    778,      0,      0, _   ],
[1911,  836,      7,     36,    792,      0,      0, _   ],
[1912,  879,      8,     37,    834,      0,      0, _   ],
[1913,  943,      8,     41,    895,      0,      0, _   ],
[1914,  850,      8,     42,    800,      0,      0, _   ],
[1915,  838,      9,     45,    784,      0,      0, _   ],
[1916,  901,     10,     48,    842,      0,      0, _   ],
[1917,  955,     11,     54,    891,      0,      0, _   ],
[1918,  936,     10,     53,    873,      0,      0, _   ],
[1919,  806,     10,     61,    735,      0,      0, _   ],
[1920,  932,     11,     78,    843,      0,      0, _   ],
[1921,  803,     10,     84,    709,      0,      0, _   ],
[1922,  845,     11,     94,    740,      0,      0, _   ],
[1923,  970,     14,    111,    845,      0,      0, _   ],
[1924,  963,     16,    110,    836,      0,      0, _   ],
[1925,  975,     17,    116,    842,      0,      0, _   ],
[1926,  983,     19,    119,    846,      0,      0, _   ],
[1927, 1062,     21,    136,    905,      0,      0, _   ],
[1928, 1065,     23,    143,    890,     10,      0, _   ],
[1929, 1145,     28,    160,    947,     10,      0, _   ],
[1930, 1053,     28,    152,    862,     10,      0, _   ],
[1931,  940,     25,    147,    759,      8,      0, _   ],
[1932,  847,     24,    141,    675,      7,      0, _   ],
[1933,  893,     25,    154,    708,      7,      0, _   ],
[1934,  973,     28,    162,    775,      8,      0, _   ],
[1935, 1027,     30,    176,    811,      9,      0, _   ],
[1936, 1130,     34,    192,    893,     11,      0, _   ],
[1937, 1209,     38,    219,    941,     11,      0, _   ],
[1938, 1142,     37,    214,    880,     12,      0, _   ],
[1939, 1192,     38,    222,    918,     13,      0, _   ],
[1940, 1299,     42,    229,   1017,     11,      0, _   ],
[1941, 1334,     42,    236,   1043,     12,      0, _   ],
[1942, 1342,     45,    222,   1063,     11,      0, _   ],
[1943, 1391,     50,    239,   1092,     10,      0, _   ],
[1944, 1383,     54,    275,   1047,      7,      0, _   ],
[1945, 1160,     59,    275,    820,      7,      0, _   ],
[1946, 1238,     61,    292,    875,     10,      0, _   ],
[1947, 1392,     67,    322,    992,     12,      0, _   ],
[1948, 1469,     76,    364,   1015,     14,      0, _   ],
[1949, 1419,     81,    362,    960,     16,      0, _],
[1950, 1630,     97,    423,   1070,     18,     23,   0.64  ],
[1951, 1767,    115,    479,   1129,     20,     24,   0.69  ],
[1952, 1795,    124,    504,   1119,     22,     26,   0.68  ],
[1953, 1841,    131,    533,   1125,     24,     27,   0.69  ],
[1954, 1865,    138,    557,   1116,     27,     27,   0.69  ],
[1955, 2042,    150,    625,   1208,     30,     31,   0.74  ],
[1956, 2177,    161,    679,   1273,     32,     32,   0.77  ],
[1957, 2270,    178,    714,   1309,     34,     35,   0.79  ],
[1958, 2330,    192,    731,   1336,     36,     35,   0.80  ],
[1959, 2454,    206,    789,   1382,     40,     36,   0.83  ],
[1960, 2569,    227,    849,   1410,     43,     39,   0.85  ],
[1961, 2580,    240,    904,   1349,     45,     42,   0.84  ],
[1962, 2686,    263,    980,   1351,     49,     44,   0.86  ],
[1963, 2833,    286,   1052,   1396,     51,     47,   0.88  ],
[1964, 2995,    316,   1137,   1435,     57,     51,   0.92  ],
[1965, 3130,    337,   1219,   1460,     59,     55,   0.94  ],
[1966, 3288,    364,   1323,   1478,     63,     60,   0.97  ],
[1967, 3393,    392,   1423,   1448,     65,     66,   0.98  ],
[1968, 3566,    424,   1551,   1448,     70,     73,   1.01  ],
[1969, 3780,    467,   1673,   1486,     74,     80,   1.05  ],
[1970, 4053,    493,   1839,   1556,     78,     87,   1.10  ],
[1971, 4208,    530,   1947,   1559,     84,     88,   1.12  ],
[1972, 4376,    560,   2057,   1576,     89,     94,   1.14  ],
[1973, 4614,    588,   2241,   1581,     95,    110,   1.18  ],
[1974, 4623,    597,   2245,   1579,     96,    107,   1.16  ],
[1975, 4596,    604,   2132,   1673,     95,     92,   1.13  ],
[1976, 4864,    630,   2314,   1710,    103,    108,   1.18],
[1977, 5026,    650,   2398,   1765,    108,    104,   1.19],
[1978, 5087,    680,   2392,   1793,    116,    106,   1.19  ],
[1979, 5369,    721,   2544,   1887,    119,     98,   1.23  ],
[1980, 5316,    740,   2422,   1947,    120,     86,   1.20  ],
[1981, 5152,    756,   2289,   1921,    121,     64,   1.14  ],
[1982, 5113,    740,   2196,   1992,    121,     64,   1.11  ],
[1983, 5094,    741,   2176,   1995,    125,     58,   1.09  ],
[1984, 5280,    808,   2199,   2094,    128,     51,   1.11  ],
[1985, 5439,    837,   2186,   2237,    131,     49,   1.12],
[1986, 5607,    831,   2293,   2300,    137,     46,   1.14  ],
[1987, 5752,    894,   2306,   2364,    143,     44,   1.15  ],
[1988, 5965,    937,   2412,   2414,    152,     50,   1.17  ],
[1989, 6097,    984,   2459,   2457,    156,     41,   1.17  ],
[1990, 6141,   1019,   2506,   2419,    157,     40,   1.16  ],
[1991, 6233,   1063,   2616,   2348,    161,     44,   1.16  ],
[1992, 6165,   1095,   2508,   2360,    167,     35,   1.13  ],
[1993, 6180,   1129,   2538,   2301,    176,     36,   1.11  ],
[1994, 6286,   1139,   2562,   2361,    186,     38,   1.12  ],
[1995, 6420,   1157,   2584,   2446,    197,     36,   1.12  ],
[1996, 6544,   1209,   2622,   2473,    203,     37,   1.13  ],
[1997, 6653,   1208,   2698,   2500,    209,     38,   1.13  ],
[1998, 6644,   1243,   2763,   2394,    209,     35,   1.12  ],
[1999, 6611,   1270,   2734,   2356,    217,     33,   1.10  ],
[2000, 6766,   1288,   2836,   2371,    226,     45,   1.11  ],
[2001, 6929,   1312,   2838,   2496,    237,     46,   1.12  ],
[2002, 6998,   1344,   2829,   2525,    252,     48,   1.12  ],
[2003, 7421,   1391,   2959,   2747,    276,     48,   1.17  ],
[2004, 7812,   1437,   3053,   2971,    298,     53,   1.21  ],
[2005, 8106,   1476,   3087,   3163,    320,     60,   1.24  ],
[2006, 8372,   1524,   3097,   3335,    355,     61,   1.27  ],
[2007, 8572,   1559,   3095,   3467,    382,     68,   1.28  ],
[2008, 8769,   1620,   3113,   3576,    388,     71,   1.30  ],
[2009, 8738,   1568,   3065,   3625,    413,     66,   1.28]
    ]
    ).

% http://www.woodfortrees.org/data/esrl-co2/compress:12
%
co2_atm(
[
[1958.21,  315.368],
[1959.21,  316.091],
[1960.21,  317.01],
[1961.21,  317.793],
[1962.21,  318.561],
[1963.21,  319.146],
[1964.21,  319.637],
[1965.21,  320.238],
[1966.21,  321.58],
[1967.21,  322.253],
[1968.21,  323.27],
[1969.21,  324.841],
[1970.21,  325.832],
[1971.21,  326.449],
[1972.21,  327.762],
[1973.21,  329.84],
[1974.21,  330.346],
[1975.21,  331.278],
[1976.21,  332.179],
[1977.21,  334.152],
[1978.21,  335.617],
[1979.21,  337.05],
[1980.21,  338.995],
[1981.21,  340.328],
[1982.21,  341.595],
[1983.21,  343.384],
[1984.21,  344.787],
[1985.21,  346.238],
[1986.21,  347.668],
[1987.21,  349.576],
[1988.21,  351.902],
[1989.21,  353.279],
[1990.21,  354.504],
[1991.21,  355.779],
[1992.21,  356.468],
[1993.21,  357.323],
[1994.21,  359.111],
[1995.21,  361.175],
[1996.21,  362.748],
[1997.21,  364.041],
[1998.21,  367.148],
[1999.21,  368.463],
[2000.21,  369.797],
[2001.21,  371.428],
[2002.21,  373.623],
[2003.21,  376.139],
[2004.21,  377.771],
[2005.21,  380.24 ],
[2006.21,  382.173],
[2007.21,  384.133],
[2008.21,  385.851],
[2009.21,  387.707],
[2010.21,  390.231],
[2011.21,  391.926]
]).


best([
[1800, -0.785917],
[1801, 0.0303333],
[1802, -0.112833],
[1803, -0.46475],
[1804, -0.327333],
[1805, -0.699333],
[1806, -0.285667],
[1807, -0.41425],
[1808, -0.940917],
[1809, -1.39883],
[1810, -1.06917],
[1811, -0.327167],
[1812, -1.6045],
[1813, -0.595917],
[1814, -0.924],
[1815, -1.09558],
[1816, -1.232],
[1817, -1.15158],
[1818, -0.588917],
[1819, -0.810083],
[1820, -0.938833],
[1821, -0.291333],
[1822, 0.104],
[1823, -0.727417],
[1824, -0.0635833],
[1825, -0.071],
[1826, -0.062],
[1827, 0.143083],
[1828, -0.508583],
[1829, -0.833333],
[1830, -0.0350833],
[1831, -1.00958],
[1832, -0.941417],
[1833, -0.336],
[1834, -0.276333],
[1835, -1.057],
[1836, -0.710417],
[1837, -0.858417],
[1838, -0.875],
[1839, -0.59975],
[1840, -0.606833],
[1841, -0.648],
[1842, -0.305917],
[1843, -0.171167],
[1844, -0.659667],
[1845, -0.515083],
[1846, 0.275583],
[1847, -0.344833],
[1848, -0.443667],
[1849, -0.389583],
[1850, -0.592583],
[1851, -0.242917],
[1852, -0.320167],
[1853, -0.412],
[1854, -0.1615],
[1855, -0.148167],
[1856, -0.461667],
[1857, -0.604083],
[1858, -0.265],
[1859, -0.218667],
[1860, -0.697083],
[1861, -0.550167],
[1862, -0.9395],
[1863, -0.198417],
[1864, -0.451583],
[1865, -0.251917],
[1866, -0.207417],
[1867, -0.0770833],
[1868, -0.240083],
[1869, -0.0536667],
[1870, -0.309083],
[1871, -0.425583],
[1872, -0.35775],
[1873, -0.195667],
[1874, -0.0805],
[1875, -0.558083],
[1876, -0.466417],
[1877, -0.0835],
[1878, 0.196583],
[1879, -0.317417],
[1880, -0.39075],
[1881, -0.230917],
[1882, -0.338],
[1883, -0.412417],
[1884, -0.60375],
[1885, -0.426833],
[1886, -0.408333],
[1887, -0.477],
[1888, -0.292333],
[1889, -0.0918333],
[1890, -0.415333],
[1891, -0.373917],
[1892, -0.35325],
[1893, -0.4165],
[1894, -0.2325],
[1895, -0.297417],
[1896, -0.213333],
[1897, -0.13825],
[1898, -0.226],
[1899, -0.0495833],
[1900, 0.00125],
[1901, 0.0265833],
[1902, -0.232417],
[1903, -0.254583],
[1904, -0.369167],
[1905, -0.2515],
[1906, -0.06375],
[1907, -0.552417],
[1908, -0.309833],
[1909, -0.317833],
[1910, -0.31475],
[1911, -0.373083],
[1912, -0.357417],
[1913, -0.222667],
[1914, 0.0689167],
[1915, 0.0516667],
[1916, -0.302083],
[1917, -0.505583],
[1918, -0.413583],
[1919, -0.235],
[1920, -0.17675],
[1921, 0.0625],
[1922, -0.14925],
[1923, -0.12075],
[1924, -0.0138333],
[1925, -0.047],
[1926, 0.1235],
[1927, -0.0740833],
[1928, 0.08025],
[1929, -0.34925],
[1930, 0.0455833],
[1931, 0.1095],
[1932, 0.114167],
[1933, -0.283917],
[1934, 0.0569167],
[1935, -0.0706667],
[1936, -0.0685],
[1937, 0.0754167],
[1938, 0.294583],
[1939, 0.172333],
[1940, 0.165083],
[1941, 0.0871667],
[1942, 0.0844167],
[1943, 0.160333],
[1944, 0.254833],
[1945, -0.0423333],
[1946, 0.0216667],
[1947, 0.1655],
[1948, 0.103417],
[1949, -0.044],
[1950, -0.271417],
[1951, -0.00758333],
[1952, -0.00758333],
[1953, 0.24925],
[1954, -0.0881667],
[1955, -0.00841667],
[1956, -0.388],
[1957, 0.05475],
[1958, 0.0774167],
[1959, 0.10975],
[1960, -0.1145],
[1961, 0.188417],
[1962, 0.0085],
[1963, 0.225833],
[1964, -0.291583],
[1965, -0.0973333],
[1966, -0.0396667],
[1967, 0.0893333],
[1968, -0.126],
[1969, -0.0655],
[1970, 0.0704167],
[1971, -0.0425],
[1972, -0.136583],
[1973, 0.38625],
[1974, -0.129667],
[1975, 0.165833],
[1976, -0.212917],
[1977, 0.274583],
[1978, 0.10375],
[1979, 0.0230833],
[1980, 0.439917],
[1981, 0.572667],
[1982, 0.0446667],
[1983, 0.426167],
[1984, 0.130833],
[1985, 0.05275],
[1986, 0.242667],
[1987, 0.383917],
[1988, 0.635917],
[1989, 0.382583],
[1990, 0.653333],
[1991, 0.620833],
[1992, 0.219167],
[1993, 0.255],
[1994, 0.456917],
[1995, 0.779583],
[1996, 0.49075],
[1997, 0.583833],
[1998, 0.908333],
[1999, 0.659],
[2000, 0.597333],
[2001, 0.809083],
[2002, 0.97625],
[2003, 0.903917],
[2004, 0.665167],
[2005, 1.10283],
[2006, 0.945833],
[2007, 1.20508],
[2008, 0.859667],
[2009, 0.905583],
[2010, 0.905583],
[2011, 0.905583]
     ]
).
