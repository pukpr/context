:- module(context_chandler_wobble, [
	  ]).

:- use_module(context_math).
:- use_module(context_stats).

:- context:register(context_chandler_wobble:navigate).
:- context:register(context_chandler_wobble:plot).

% test_period(N,_,Period) :- Period is N*N/20*12+N*2.134.
test_period(_,P,P).
%diup(-0.16,-1.5,W) :- W is 2*pi/(17.8*12).
%yp(0.0,1.0).
diup(0.0,0.0,0.0) :- W is 2*pi/(17.8*12).
yp(0.0,0.0).
% diup(-0.4,-3.0,W) :- W is 2*pi/(18.1*12).
% yp(0.11,1.0).


mod_sin_period(0.0,N,M,_,0) :- N =< M.
mod_sin_period(Period,N,M,X,Y) :-
	 N =< M,diup(A,T,W), yp(AY,TY), test_period(N,Period,P), Y is sin(2*pi*X/P+A*sin(W*X+T)+AY*sin(W*X+TY)).
mod_sin_period(_,N,M,_,0.0) :- N > M.
% mod_sin_period(Period,N,M,X,Y) :- P is 1.0*Period, Y is sin(2*pi*X/P).

mod_cos_period(0.0,N,M,_,0) :- N =< M.
mod_cos_period(Period,N,M,X,Y) :-
	N =< M,diup(A,T,W), yp(AY,TY), test_period(N,Period,P), Y is cos(2*pi*X/P+A*sin(W*X+T)+AY*sin(W*X+TY)).
mod_cos_period(_,N,M,_,0.0) :- N > M.
% mod_cos_period(Period,N,M,X,Y) :- P is 1.0*Period, Y is cos(2*pi*X/P).

yearly_qmod(X,Y) :- Y is 1.0 - 0.0*cos(2*pi*X/12/2.3334+4.2).

%biamp(X,Amp) :- Amp is (1-0.2*cos(2*pi/(10.1*12)*X - 0.7)).
%bimod(X,Mod) :- Mod is 0.7*cos(2*pi/(17.9*12)*X + 0.9).
biamp(X,Amp) :- Amp is (1-0.21*cos(2*pi/(10.09*12)*X - 0.66)).
bimod(X,Mod) :- Mod is 0.68*cos(2*pi/(17.9*12)*X + 0.9).
% biamp(_,1.0).
% bimod(_,0.0).
% sin_biennial_period(X,Y) :- X > 76*12, bimod(X,M), biamp(X,A), Y is A*sin(2*pi*X/24+M), !.
%
sin_biennial_period(X,Y) :-  bimod(X,M), biamp(X,A), Y is -A*sin(2*pi*X/24+M).

%  cos_biennial_period(X,Y) :- X > 76*12, bimod(X,M), biamp(X,A), Y is A*cos(2*pi*X/24+M), !.
%
cos_biennial_period(X,Y) :-  bimod(X,M),  biamp(X,A), Y is -A*cos(2*pi*X/24+M+0.0).


yearly_mod(X,Y) :- Y is 1.0 + 0*0.15*cos(2*pi*X/12+0.4).

% mathieu_mod(X,Y) :- Y is 5.0*cos(2*pi*X/10.201+2.4).
% mathieu_mod(X,Y) :- Y is -0.6*(1.0+0*0.3*cos(2*pi*X/9.3+0.2)).
% mathieu_mod(X,Y) :- Y is -1.0*(1.0 +0.3*cos(2*pi*X/8.3-1.8)).
% mathieu_mod(X,Y) :- Y is -0.7*(1.0+1.0*cos(2*pi*X/2.0+2.6)).
%  mathieu_mod(X,Y) :- Y is
% -0.7*(1.0+0*0.9*cos(2*pi*X/10.6+4.4)*cos(2*pi*X/2.33-2.4)).
mathieu_mod(X,Y) :- Y is -0.7*(1.0-0*0.4*cos(2*pi*X/2.33-2.4)).

/*yearly_sin_period(0.0,N,M,_,0) :- N =< M.
yearly_sin_period(Period,N,M,X,Y) :- N =< M, test_period(N,Period,P), Y is sin(2*pi*X/P).
yearly_sin_period(_,N,M,_,0.0) :- N > M.
yearly_cos_period(0.0,N,M,_,0) :- N =< M.
yearly_cos_period(Period,N,M,X,Y) :- N =< M, test_period(N,Period,P), Y is cos(2*pi*X/P).
yearly_cos_period(_,N,M,_,0.0) :- N > M.
*/

cwx([
-0.212818	,
-0.047461	,
-0.112006	,
-0.07671	,
-0.09985	,
-0.131173	,
-0.08739	,
-0.164078	,
-0.151407	,
-0.143764	,
-0.124341	,
-0.206229	,
-0.192711	,
-0.190299	,
-0.135718	,
-0.153807	,
-0.173818	,
-0.257716	,
-0.209085	,
-0.133145	,
-0.138242	,
-0.162602	,
-0.121242	,
-0.109773	,
-0.103805	,
-0.021306	,
-0.0013	,
0.037156	,
0.003993	,
0.054079	,
0.089761	,
0.004864	,
-0.023099	,
-0.05791	,
-0.03317	,
-0.155604	,
-0.169658	,
-0.188623	,
-0.223086	,
-0.254958	,
-0.259243	,
-0.211792	,
-0.216991	,
-0.242537	,
-0.188324	,
-0.15257	,
-0.062244	,
-0.016045	,
0.036032	,
0.217293	,
0.119283	,
0.125538	,
0.082496	,
0.051287	,
0.051239	,
-0.024248	,
-0.054789	,
-0.14632	,
-0.193061	,
-0.237694	,
-0.31942	,
-0.341204	,
-0.34593	,
-0.363449	,
-0.363639	,
-0.275204	,
-0.217973	,
-0.133649	,
-0.073538	,
-0.033275	,
-0.025665	,
0.065994	,
0.124642	,
0.138085	,
0.131036	,
0.129875	,
0.020188	,
-0.013164	,
0.0172	,
-0.054459	,
-0.148856	,
-0.254004	,
-0.260513	,
-0.25064	,
-0.31845	,
-0.293126	,
-0.24923	,
-0.26386	,
-0.210918	,
-0.1527	,
-0.109676	,
-0.082798	,
0.0015	,
0.042084	,
0.062535	,
0.083512	,
0.042326	,
0.042284	,
-0.008473	,
0.028258	,
-0.040538	,
-0.017099	,
-0.105713	,
-0.176213	,
-0.231493	,
-0.25144	,
-0.248	,
-0.304428	,
-0.236545	,
-0.250592	,
-0.18596	,
-0.156532	,
-0.109352	,
-0.067846	,
0.014037	,
-0.034403	,
-0.031721	,
0.025746	,
0.024021	,
0.040706	,
0.003853	,
-0.017613	,
-0.157406	,
-0.067506	,
-0.14945	,
-0.128247	,
-0.179648	,
-0.186449	,
-0.208575	,
-0.21787	,
-0.199891	,
-0.173543	,
-0.182003	,
-0.142776	,
-0.09374	,
-0.0939	,
-0.102758	,
-0.009641	,
-0.126885	,
-0.08594	,
-0.079416	,
-0.06735	,
-0.027042	,
-0.069913	,
-0.059194	,
-0.032978	,
-0.032298	,
-0.0128	,
-0.094517	,
-0.089447	,
-0.131771	,
-0.109356	,
-0.134764	,
-0.150915	,
-0.183652	,
-0.247755	,
-0.276782	,
-0.260675	,
-0.279309	,
-0.247411	,
-0.179825	,
-0.162104	,
-0.073775	,
-0.088534	,
0.072181	,
0.000811	,
0.09429	,
0.098031	,
0.085376	,
0.110614	,
0.110175	,
0.062891	,
0.016036	,
-0.044507	,
-0.126698	,
-0.185227	,
-0.218671	,
-0.258124	,
-0.348498	,
-0.441656	,
-0.418026	,
-0.4647	,
-0.381402	,
-0.331872	,
-0.2628	,
-0.180022	,
-0.088674	,
-0.0173	,
0.082311	,
0.145682	,
0.159939	,
0.219001	,
0.251107	,
0.216	,
0.239771	,
0.12203	,
-0.027219	,
-0.097816	,
-0.212272	,
-0.262295	,
-0.323074	,
-0.442329	,
-0.448532	,
-0.408744	,
-0.41402	,
-0.385676	,
-0.368387	,
-0.268774	,
-0.147573	,
-0.081273	,
-0.020932	,
0.105674	,
0.176301	,
0.191756	,
0.222257	,
0.211332	,
0.205	,
0.1209	,
0.083916	,
-0.057477	,
-0.089579	,
-0.218786	,
-0.2247	,
-0.33586	,
-0.267	,
-0.370633	,
-0.353109	,
-0.332727	,
-0.234107	,
-0.272718	,
-0.193283	,
-0.136796	,
-0.05677	,
0.0606	,
0.112694	,
0.129599	,
0.130866	,
0.158551	,
0.145314	,
0.095603	,
0.083131	,
-0.038956	,
0.0783	,
-0.088995	,
-0.127587	,
-0.227272	,
-0.209405	,
-0.237021	,
-0.262082	,
-0.22532	,
-0.263907	,
-0.196951	,
-0.198267	,
-0.219124	,
-0.175982	,
-0.16028	,
-0.1032	,
-0.078852	,
-0.076719	,
-0.0182	,
-0.088918	,
-0.043449	,
-0.001323	,
-0.021744	,
0.011122	,
-0.010477	,
0.032491	,
0.048101	,
0.032669	,
0.008311	,
0.000027	,
-0.076685	,
-0.108057	,
-0.1004	,
-0.162152	,
-0.223157	,
-0.224	,
-0.226344	,
-0.20056	,
-0.3133	,
-0.203986	,
-0.260937	,
-0.152037	,
-0.093945	,
-0.063798	,
-0.013635	,
0.045383	,
0.034013	,
0.073793	,
0.106389	,
0.104207	,
0.085502	,
0.049258	,
-0.013923	,
-0.046141	,
-0.094789	,
-0.140169	,
-0.220007	,
-0.271487	,
-0.197162	,
-0.365371	,
-0.31139	,
-0.363577	,
-0.230546	,
-0.285678	,
-0.300793	,
-0.145488	,
-0.084157	,
-0.0084	,
0.086674	,
0.081245	,
0.12165	,
0.169064	,
0.112084	,
0.099188	,
0.093628	,
-0.031363	,
-0.05002	,
-0.047776	,
-0.135461	,
-0.250486	,
-0.33903	,
-0.414793	,
-0.341536	,
-0.344556	,
-0.312204	,
-0.283589	,
-0.251093	,
-0.158543	,
-0.236712	,
-0.049133	,
-0.019	,
0.09166	,
0.171184	,
0.1355	,
0.159276	,
0.195249	,
0.041662	,
0.012991	,
-0.003679	,
-0.095516	,
-0.151536	,
-0.182049	,
-0.292198	,
-0.293211	,
-0.310501	,
-0.262144	,
-0.195616	,
-0.216823	,
-0.195552	,
-0.114387	,
-0.014913	,
-0.032948	,
-0.004274	,
-0.0293	,
0.047363	,
0.027454	,
0.086395	,
0.011086	,
0.061347	,
-0.0458	,
-0.063352	,
-0.14038	,
-0.13959	,
-0.186229	,
-0.197272	,
-0.162233	,
-0.209522	,
-0.183315	,
-0.18612	,
-0.206139	,
-0.1405	,
-0.075624	,
-0.03525	,
-0.038388	,
0.005607	,
-0.039489	,
-0.0474	,
-0.061884	,
-0.059354	,
-0.058158	,
-0.045037	,
-0.064165	,
-0.046142	,
-0.076649	,
-0.032	,
-0.032764	,
-0.034002	,
-0.081513	,
-0.024396	,
-0.005435	,
-0.0367	,
-0.05448	,
-0.109833	,
-0.180209	,
-0.14405	,
-0.181892	,
-0.159213	,
-0.092562	,
-0.186227	,
-0.097388	,
-0.145513	,
-0.06601	,
-0.108	,
-0.066646	,
0.062692	,
0.077897	,
0.11262	,
0.081	,
0.148386	,
0.11177	,
0.063562	,
0.129866	,
0.091341	,
0.068767	,
-0.008467	,
-0.05251	,
-0.131312	,
-0.098074	,
-0.202848	,
-0.2751	,
-0.19938	,
-0.269861	,
-0.3157	,
-0.190287	,
-0.119466	,
-0.014599	,
0.031054	,
0.09182	,
0.100985	,
0.212445	,
0.138182	,
0.178414	,
0.167323	,
0.073545	,
0.127179	,
-0.002474	,
-0.007518	,
-0.098209	,
-0.133071	,
-0.045524	,
-0.194756	,
-0.208934	,
-0.2103	,
-0.165744	,
-0.16239	,
-0.132697	,
-0.090259	,
-0.04748	,
0.00907	,
0.111622	,
0.08877	,
0.163154	,
0.151317	,
0.1418	,
0.120772	,
0.083381	,
0.063654	,
0.041976	,
-0.163179	,
-0.162345	,
-0.166986	,
-0.332673	,
-0.262008	,
-0.207748	,
-0.274792	,
-0.179152	,
-0.176779	,
-0.097364	,
-0.024124	,
-0.019994	,
0.060132	,
0.112367	,
0.142183	,
0.15178	,
0.16199	,
0.130175	,
0.136144	,
0.088243	,
0.035504	,
-0.005804	,
-0.068517	,
-0.029063	,
-0.1495	,
-0.151107	,
-0.170714	,
-0.1274	,
-0.165261	,
-0.187563	,
-0.08198	,
-0.075229	,
-0.059435	,
0.014627	,
0.029893	,
-0.002107	,
0.041539	,
0.032319	,
-0.079291	,
-0.006172	,
0.035597	,
-0.012995	,
-0.056182	,
-0.103481	,
-0.107312	,
-0.141179	,
-0.102647	,
-0.130539	,
-0.066774	,
-0.004013	,
-0.066873	,
-0.055672	,
-0.070311	,
0.017853	,
-0.015743	,
0.001485	,
-0.005631	,
0.001128	,
-0.243256	,
-0.025734	,
-0.041648	,
-0.199605	,
-0.163818	,
-0.073051	,
-0.177265	,
-0.230084	,
-0.173813	,
-0.052708	,
-0.106664	,
-0.129567	,
-0.076581	,
-0.051765	,
-0.033933	,
-0.053049	,
-0.021532	,
0.018915	,
-0.001894	,
-0.075772	,
-0.120294	,
-0.050061	,
-0.098525	,
-0.0582	,
-0.142988	,
-0.032237	,
-0.095191	,
-0.059447	,
-0.115876	,
-0.052232	,
-0.054137	,
-0.013624	,
0.095331	,
0.015128	,
-0.016024	,
-0.031647	,
-0.020014	,
-0.004146	,
-0.052691	,
-0.052571	,
-0.093446	,
-0.185615	,
-0.159711	,
-0.008822	,
-0.1457	,
-0.13467	,
-0.142914	,
-0.130658	,
-0.071799	,
-0.077913	,
-0.084562	,
-0.070452	,
-0.071262	,
-0.023166	,
-0.049392	,
-0.132084	,
0.020427	,
-0.028438	,
-0.1101	,
-0.143376	,
-0.115036	,
-0.110841	,
-0.072093	,
-0.160303	,
-0.288649	,
-0.100071	,
-0.169363	,
-0.126222	,
-0.057249	,
0.003629	,
0.131595	,
0.031158	,
0.06922	,
0.103978	,
0.082883	,
0.049832	,
0.073767	,
0.084972	,
-0.015329	,
-0.093999	,
-0.161299	,
-0.165908	,
-0.205862	,
-0.214153	,
-0.215942	,
-0.22548	,
-0.206525	,
-0.166814	,
-0.130922	,
-0.049593	,
-0.1252	,
0.006745	,
0.017674	,
0.035577	,
0.081022	,
0.098407	,
0.074379	,
0.062912	,
0.028598	,
-0.011225	,
-0.084804	,
-0.116025	,
-0.158405	,
-0.353309	,
-0.277671	,
-0.239	,
-0.355078	,
-0.226864	,
-0.248657	,
-0.150564	,
-0.151393	,
-0.039529	,
0.024987	,
0.0396	,
0.074415	,
0.098426	,
0.082462	,
0.165785	,
0.067878	,
0.052973	,
-0.08359	,
-0.060868	,
-0.091079	,
-0.117202	,
-0.196529	,
-0.1662	,
-0.312357	,
-0.324819	,
-0.229236	,
-0.19945	,
-0.169007	,
-0.13835	,
-0.07167	,
-0.075142	,
-0.05207	,
0.026338	,
0.0718	,
0.070092	,
0.087369	,
0.122666	,
0.085699	,
0.094388	,
0.097006	,
-0.073655	,
-0.058596	,
-0.18803	,
-0.173476	,
-0.221474	,
-0.211408	,
-0.186714	,
-0.179116	,
-0.132931	,
-0.129933	,
-0.0658	,
-0.061257	,
-0.09289	,
-0.011311	,
-0.04156	,
-0.007268	,
-0.0481	,
-0.030166	,
-0.059454	,
-0.000334	,
-0.047994	,
-0.12833	,
-0.104712	,
-0.123185	,
-0.156884	,
-0.146878	,
-0.212952	,
-0.10968	,
-0.064907	,
-0.115818	,
-0.0936	,
-0.026049	,
-0.036375	,
-0.0182	,
0.003251	,
-0.019469	,
0.0164	,
0.017784	,
-0.064537	,
-0.095694	,
-0.053671	,
-0.169016	,
0.0059	,
-0.121309	,
-0.067132	,
-0.065954	,
-0.066468	,
-0.021635	,
-0.033804	,
-0.056658	,
-0.05209	,
-0.17779	,
-0.039043	,
-0.133855	,
-0.005002	,
-0.05539	,
-0.109561	,
-0.17368	,
-0.136077	,
-0.015578	,
0.023251	,
-0.146877	,
-0.0475	,
-0.125964	,
-0.159573	,
-0.1067	,
-0.080483	,
-0.093917	,
-0.037416	,
0.06045	,
-0.013617	,
-0.000451	,
-0.004315	,
-0.043164	,
-0.018826	,
-0.07457	,
-0.106024	,
-0.100771	,
-0.188334	,
-0.1733	,
-0.140145	,
-0.193481	,
-0.158811	,
-0.245489	,
-0.176313	,
-0.121499	,
-0.116696	,
-0.040102	,
-0.088573	,
0.03532	,
0.073386	,
0.0691	,
0.090711	,
0.056677	,
0.047138	,
-0.015251	,
-0.00868	,
-0.107027	,
-0.10506	,
-0.21741	,
-0.204894	,
-0.303156	,
-0.147755	,
-0.221442	,
-0.226757	,
-0.171954	,
-0.138432	,
-0.116911	,
-0.046436	,
-0.080914	,
0.111257	,
0.1097	,
0.174186	,
0.172035	,
0.075919	,
0.167309	,
0.026111	,
-0.037869	,
-0.052264	,
-0.134539	,
-0.301769	,
-0.116858	,
-0.213896	,
-0.1613	,
-0.181054	,
-0.192526	,
-0.119371	,
-0.079336	,
-0.087263	,
-0.044976	,
0.023086	,
0.0725	,
0.118411	,
0.146657	,
0.095496	,
0.089672	,
0.069378	,
0.042361	,
0.005289	,
-0.058344	,
0.027411	,
-0.148565	,
-0.24917	,
-0.210741	,
-0.226589	,
-0.2901	,
-0.223492	,
-0.135189	,
-0.175712	,
-0.063144	,
-0.029661	,
0.019816	,
0.162656	,
0.098439	,
0.0658	,
0.125165	,
0.070275	,
0.0533	,
0.0043	,
-0.049213	,
0.033843	,
0.033262	,
-0.043717	,
-0.000032	,
0.008262	,
-0.118927	,
-0.183857	,
-0.159123	,
-0.08848	,
-0.092443	,
-0.06226	,
-0.073372	,
0.012678	,
-0.041165	,
-0.086224	,
0.001683	,
0.068909	,
-0.028851	,
-0.020115	,
0.145863	,
-0.0297	,
-0.086609	,
0.034025	,
-0.065983	,
-0.026845	,
-0.066569	,
-0.008392	,
-0.012154	,
-0.068264	,
-0.064544	,
-0.032732	,
-0.007371	,
-0.089026	,
-0.07518	,
-0.036158	,
-0.075817	,
-0.089165	,
-0.152931	,
-0.103187	,
-0.039915	,
-0.090405	,
-0.093652	,
-0.061971	,
-0.080573	,
-0.051329	,
0.001923	,
-0.019745	,
0.035917	,
0.078661	,
0.033384	,
0.105491	,
-0.047847	,
-0.036338	,
0.022793	,
0.070899	,
0.004438	,
-0.122806	,
-0.144327	,
-0.120953	,
-0.253705	,
-0.188535	,
-0.21317	,
-0.133388	,
-0.243714	,
-0.280687	,
-0.099857	,
-0.102089	,
0.034173	,
0.052475	,
0.2043	,
0.17493	,
0.236527	,
0.208915	,
0.171265	,
0.15883	,
-0.041184	,
-0.054199	,
-0.122864	,
-0.173922	,
-0.266129	,
-0.117527	,
-0.172366	,
-0.218168	,
-0.26938	,
-0.105476	,
-0.252149	,
-0.1191	,
-0.098829	,
0.041205	,
0.0701	,
0.161286	,
0.111735	,
0.27993	,
0.210791	,
0.167958	,
0.387534	,
0.203824	,
-0.009562	,
0.082043	,
-0.167775	,
-0.105894	,
-0.2388	,
-0.161621	,
-0.29212	,
-0.369539	,
-0.243748	,
-0.2607	,
-0.227834	,
-0.10589	,
-0.219288	,
-0.063112	,
0.056826	,
0.082673	,
0.134672	,
0.188918	,
0.230337	,
0.230653	,
0.324003	,
0.08343	,
0.071411	,
0.033741	,
-0.003804	,
-0.105253	,
-0.140851	,
-0.217901	,
-0.204585	,
-0.26005	,
-0.358491	,
-0.202905	,
-0.254945	,
-0.137802	,
-0.094877	,
0.023089	,
0.060945	,
0.113078	,
0.12002	,
0.175924	,
0.206992	,
0.140099	,
0.157648	,
0.225955	,
0.157129	,
0.150055	,
0.171585	,
0.1454	,
0.14768	,
0.053983	,
-0.045837	,
-0.091431	,
-0.07606	,
-0.106057	,
-0.097516	,
-0.130026	,
-0.136613	,
-0.236212	,
-0.122022	,
-0.082996	,
-0.102718	,
-0.056364	,
-0.060517	,
-0.038708	,
0.050766	,
-0.036412	,
0.092035	,
0.117	,
0.167243	,
0.167879	,
0.134722	,
0.14523	,
0.089326	,
0.154408	,
0.073064	,
0.043289	,
-0.013262	,
-0.164254	,
-0.163827	,
-0.236686	,
-0.237557	,
-0.224455	,
-0.290753	,
-0.22093	,
-0.222249	,
-0.144425	,
-0.061597	,
0.023935	,
0.046105	,
0.127597	,
0.2581	,
0.238376	,
0.300481	,
0.287564	,
0.286892	,
0.270451	,
0.25883	,
0.116078	,
-0.010608	,
-0.087101	,
-0.183732	,
-0.306855	,
-0.321363	,
-0.365022	,
-0.304225	,
-0.369566	,
-0.378609	,
-0.253183	,
-0.183608	,
-0.113043	,
0.0254	,
0.169217	,
0.25173	,
0.268771	,
0.325834	,
0.416116	,
0.3693	,
0.311161	,
0.291955	,
0.143989	,
0.078168	,
-0.072498	,
-0.121266	,
-0.228941	,
-0.384844	,
-0.425432	,
-0.415187	,
-0.43805	,
-0.373937	,
-0.214791	,
-0.237011	,
-0.206498	,
-0.114247	,
0.053909	,
0.152162	,
0.302914	,
0.303583	,
0.379665	,
0.284255	,
0.290673	,
0.273678	,
0.201204	,
0.092473	,
0.123811	,
-0.059768	,
-0.099969	,
-0.11782	,
-0.288724	,
-0.256646	,
-0.275672	,
-0.3433	,
-0.325734	,
-0.275838	,
-0.079095	,
-0.02926	,
0.021387	,
0.0223	,
0.219443	,
0.20416	,
0.1974	,
0.224082	,
0.236336	,
0.1842	,
0.136603	,
0.01532	,
0.036575	,
-0.024887	,
-0.154021	,
-0.164556	,
-0.195623	,
-0.239513	,
-0.212137	,
-0.13396	,
-0.215416	,
-0.127059	,
-0.161882	,
0.022753	,
-0.093222	,
-0.075965	,
0.01	,
-0.019012	,
-0.029023	,
0.099499	,
0.017291	,
0.124344	,
0.029988	,
0.124568	,
0.158988	,
0.105321	,
0.046473	,
0.065044	,
0.041687	,
-0.001269	,
-0.055935	,
0.003124	,
-0.109785	,
-0.137337	,
-0.226992	,
-0.229553	,
-0.2196	,
-0.189281	,
-0.219306	,
-0.203131	,
-0.070247	,
-0.007398	,
0.016713	,
0.038798	,
0.117409	,
0.083759	,
0.152189	,
0.160798	,
0.211912	,
0.219468	,
0.212688	,
0.169132	,
0.146149	,
0.059496	,
0.018377	,
-0.050507	,
-0.204692	,
-0.228535	,
-0.318792	,
-0.29053	,
-0.401787	,
-0.34071	,
-0.222754	,
-0.224552	,
-0.194858	,
-0.0993	,
0.00792	,
0.076323	,
0.152477	,
0.23524	,
0.240076	,
0.292684	,
0.345486	,
0.27111	,
0.229	,
0.126351	,
0.039747	,
-0.003182	,
-0.0699	,
-0.209601	,
-0.305232	,
-0.343994	,
-0.333001	,
-0.335927	,
-0.305676	,
-0.3008	,
-0.17903	,
-0.101308	,
-0.041921	,
0.051783	,
0.098517	,
0.1809	,
0.203233	,
0.303286	,
0.276253	,
0.267226	,
0.266128	,
0.213073	,
0.164238	,
0.101815	,
0.016105	,
-0.095165	,
-0.153168	,
-0.195475	,
-0.253927	,
-0.238076	,
-0.240657	,
-0.252739	,
-0.214144	,
-0.142987	,
-0.037927	,
-0.0348	,
0.106849	,
0.129032	,
0.175804	,
0.222541	,
0.203199	,
0.202366	,
0.175341	,
0.13203	,
0.008173	,
-0.003037	,
-0.096783	,
-0.049029	,
-0.070352	,
-0.093472	,
-0.144743	,
-0.136289	,
-0.1856	,
-0.144215	,
-0.093892	,
-0.1419	,
-0.082108	,
-0.054888	,
0.0005	,
0.027616	,
0.028359	,
-0.026324	,
0.045255	,
0.018041	,
-0.010002	,
0.014227	,
-0.034519	,
0.020541	,
-0.00886	,
-0.009493	,
-0.013247	,
-0.011871	,
-0.055595	,
-0.006478	,
-0.052932	,
-0.008206	,
-0.051487	,
-0.017757	,
-0.06201	,
-0.08109	,
-0.110423	,
-0.0903	,
-0.167482	,
-0.142626	,
-0.012146	,
-0.053715	,
-0.060187	,
-0.037113	,
0.002442	,
0.042505	,
0.074051	,
0.091337	,
0.096734	,
0.098567	,
0.098411	,
0.090464	,
0.073881	,
0.048858	,
0.01497	,
-0.025045	,
-0.067963	,
-0.098597	,
-0.122384	,
-0.15887	,
-0.195503	,
-0.204102	,
-0.179911	,
-0.143183	,
-0.098858	,
-0.043127	,
0.021698	,
0.089519	,
0.147203	,
0.191205	,
0.220046	,
0.223976	,
0.200003	,
0.153421	,
0.100524	,
0.044175	,
-0.025423	,
-0.096923	,
-0.146973	,
-0.181605	,
-0.226399	,
-0.278957	,
-0.305949	,
-0.288587	,
-0.241705	,
-0.179987	,
-0.112266	,
-0.050383	,
0.006612	,
0.065351	,
0.124134	,
0.178818	,
0.222446	,
0.241917	,
0.232794	,
0.203675	,
0.160609	,
0.105049	,
0.042688	,
-0.017533	,
-0.075666	,
-0.135222	,
-0.187283	,
-0.2223	,
-0.241459	,
-0.238183	,
-0.214874	,
-0.185335	,
-0.153066	,
-0.104956	,
-0.034508	,
0.035275	,
0.079054	,
0.106405	,
0.137807	,
0.170959	,
0.192139	,
0.188075	,
0.1581	,
0.110035	,
0.055775	,
0.00786	,
-0.036921	,
-0.082554	,
-0.117258	,
-0.14182	,
-0.161535	,
-0.164819	,
-0.150683	,
-0.129982	,
-0.108304	,
-0.082426	,
-0.052825	,
-0.021678	,
0.010556	,
0.046335	,
0.079564	,
0.10296	,
0.121406	,
0.124935	,
0.099821	,
0.063159	,
0.037128	,
0.023813	,
0.014875	,
0.005221	,
-0.005243	,
-0.009768	,
-0.005718	,
-0.002255	,
-0.004849	,
-0.008833	,
-0.011356	,
-0.015415	,
-0.02469	,
-0.031617	,
-0.032519	,
-0.030515	,
-0.028333	,
-0.029006	,
-0.02699	,
-0.01842	,
-0.008023	,
0.007679	,
0.022623	,
0.031213	,
0.044716	,
0.056276	,
0.058146	,
0.060132	,
0.065532	,
0.06469	,
0.050929	,
0.029267	,
0.007725	,
-0.012474	,
-0.041922	,
-0.085841	,
-0.12481	,
-0.136786	,
-0.130188	,
-0.117742	,
-0.106561	,
-0.096173	,
-0.075217	,
-0.038842	,
0.00397	,
0.048499	,
0.089217	,
0.119189	,
0.136234	,
0.141414	,
0.136025	,
0.121837	,
0.09683	,
0.059869	,
0.020041	,
-0.016972	,
-0.061477	,
-0.115511	,
-0.167434	,
-0.200325	,
-0.201268	,
-0.178964	,
-0.157857	,
-0.134033	,
-0.092958	,
-0.040959	,
0.015192	,
0.074838	,
0.130403	,
0.172296	,
0.197571	,
0.206583	,
0.201811	,
0.179825	,
0.135202	,
0.073911	,
0.012354	,
-0.042886	,
-0.093728	,
-0.14375	,
-0.191547	,
-0.22779	,
-0.239776	,
-0.226523	,
-0.205015	,
-0.177088	,
-0.126667	,
-0.051997	,
0.029664	,
0.102349	,
0.163444	,
0.210069	,
0.231622	,
0.228218	,
0.208918	,
0.180763	,
0.142844	,
0.091327	,
0.029529	,
-0.032666	,
-0.08404	,
-0.124769	,
-0.163125	,
-0.18623	,
-0.191409	,
-0.17946	,
-0.14973	,
-0.104653	,
-0.051442	,
0.005087	,
0.055725	,
0.09086	,
0.113782	,
0.134286	,
0.154647	,
0.162118	,
0.155208	,
0.142907	,
0.125418	,
0.096766	,
0.058467	,
0.021328	,
-0.017114	,
-0.05408	,
-0.087585	,
-0.110768	,
-0.122803	,
-0.120552	,
-0.101496	,
-0.074175	,
-0.047087	,
-0.018204	,
0.013458	,
0.04492	,
0.06864	,
0.083155	,
0.094237	,
0.10743	,
0.113527	,
0.103105	,
0.086922	,
0.073799	,
0.053491	,
0.035193	,
0.025545	,
0.012128	,
-0.004144	,
-0.007713	,
0.004	,
0.008555	,
0.00856	,
0.008565	,
0.008282	,
0.000812	,
-0.013271	,
-0.024525	,
-0.034442	,
-0.042417	,
-0.048694	,
-0.048904	,
-0.036096	,
-0.015983	,
0.010368	,
0.041745	,
0.06909	,
0.087361	,
0.103715	,
0.126392	,
0.141636	,
0.138623	,
0.1299	,
0.11892	,
0.096236	,
0.061174	,
0.016208	,
-0.03504	,
-0.07835	,
-0.116629	,
-0.142424	,
-0.153993	,
-0.154775	,
-0.142575	,
-0.121729	,
-0.092068	,
-0.048916	,
-0.000834	,
0.049668	,
0.105084	,
0.157618	,
0.202391	,
0.232036	,
0.239387	,
0.224605	,
0.198539	,
0.166266	,
0.122684	,
0.06729	,
0.001215	,
-0.070348	,
-0.133937	,
-0.185665	,
-0.222741	,
-0.235742	,
-0.219148	,
-0.179574	,
-0.13286	,
-0.073739	,
0.004812	,
0.088295	,
0.15845	,
0.212758	,
0.25442	,
0.279451	,
0.277336	,
0.2493	,
0.201425	,
0.141342	,
0.071885	,
0.001511	,
-0.066282	,
-0.132976	,
-0.184318	,
-0.216766	,
-0.226974	,
-0.21802	,
-0.198115	,
-0.165248	,
-0.109046	,
-0.045131	,
0.022768	,
0.09711	,
0.153653	,
0.194993	,
0.224049	,
0.234681	,
0.226561	,
0.207414	,
0.176004	,
0.138907	,
0.089433	,
0.031047	,
-0.01641	,
-0.06278	,
-0.105302	,
-0.137352	,
-0.151103	,
-0.152353	,
-0.14648	,
-0.126844	,
-0.089673	,
-0.03847	,
0.014302	,
0.057522	,
0.087122	,
0.104859	,
0.132917	,
0.132919	,
0.135667	,
0.141636	,
0.121085	,
0.089697	,
0.064338	,
0.042623	,
0.010625	,
-0.021342	,
-0.044579	,
-0.053318	,
-0.055955	,
-0.05315	,
-0.040616	,
-0.036372	,
-0.031768	,
-0.031172	,
-0.023974	,
-0.013449	,
-0.000403	,
0.021836	,
0.047814	,
0.072099	,
0.078075	,
0.089976	,
0.086078	,
0.09015	,
0.102156	,
0.09723	,
0.094156	,
0.091628	,
0.077467	,
0.067424	,
0.059108	,
0.033174	,
0.003286	,
-0.023606	,
-0.061121	,
-0.085739	,
-0.104819	,
-0.110408	,
-0.113335	,
-0.093667	,
-0.058508	,
-0.028917	,
0.016403	,
0.063465	,
0.108882	,
0.14348	,
0.174657	,
0.202518	,
0.22617	,
0.225415	,
0.210689	,
0.186412	,
0.146642	,
0.090753	,
0.026985	,
-0.036508	,
-0.092422	,
-0.143563	,
-0.185616	,
-0.202842	,
-0.209593	,
-0.187892	,
-0.165388	,
-0.128444	,
-0.059032	,
0.018365	,
0.087272	,
0.16577	,
0.220679	,
0.269611	,
0.308194	,
0.324348	,
0.313463	,
0.271649	,
0.21304	,
0.145169	,
0.061654	,
-0.016814	,
-0.084236	,
-0.133778	,
-0.180346	,
-0.220482	,
-0.242062	,
-0.241549	,
-0.217428	,
-0.16743	,
-0.10531	,
-0.038349	,
0.04348	,
0.119858	,
0.191614	,
0.256372	,
0.293733	,
0.306395	,
0.312251	,
0.285195	,
0.248381	,
0.197016	,
0.125693	,
0.043193	,
-0.022244	,
-0.080236	,
-0.134718	,
-0.186528	,
-0.200516	,
-0.197181	,
-0.181876	,
-0.138515	,
-0.096459	,
-0.044321	,
0.017743	,
0.076028	,
0.135078	,
0.182344	,
0.210662	,
0.225899	,
0.228292	,
0.227596	,
0.208318	,
0.184646	,
0.149274	,
0.096895	,
0.049754	,
-0.005428	,
-0.045014	,
-0.075485	,
-0.092272	,
-0.10306	,
-0.099075	,
-0.071516	,
-0.044781	,
-0.017196	,
0.012196	,
0.03857	,
0.06134	,
0.086075	,
0.107679	,
0.121199	,
0.139104	,
0.145562	,
0.140039	,
0.128958	,
0.121927	,
0.109535	,
0.093656	,
0.071863	,
0.053941	,
0.027745	,
0.012734	,
-0.005929	,
-0.024613	,
-0.033184	,
-0.037626	,
-0.043884	,
-0.056282	,
-0.063785	,
-0.06045	,
-0.057193	,
-0.050054	,
-0.024757	,
0.004465	,
0.046537	,
0.066786	,
0.105598	,
0.132851	,
0.150408	,
0.170008	,
0.176323	,
0.164641	,
0.168932	,
0.162665	,
0.139847	,
0.10742	,
0.064821	,
0.008734	,
-0.050505	,
-0.101042	,
-0.138668	,
-0.164713	,
-0.160692	,
-0.143969	,
-0.118172	,
-0.075655	,
-0.027166	,
0.029336	,
0.085775	,
0.127056	,
0.168786	,
0.204704	,
0.238775	,
0.258904	,
0.259492	,
0.250345	,
0.216535	,
0.166568	,
0.098478	,
0.03178	,
-0.037467	,
-0.090908	,
-0.133339	,
-0.16592	,
-0.2024	,
-0.202413	,
-0.185319	,
-0.154975	,
-0.101414	,
-0.049238	,
0.025256	,
0.096403	,
0.166279	,
0.230266	,
0.275928	,
0.304808	,
0.311951	,
0.295498	,
0.258532	,
0.213793	,
0.158109	,
0.092495	,
0.021842	,
-0.040168	,
-0.104442	,
-0.159494	,
-0.194344	,
-0.21828	,
-0.212529	,
-0.196251	,
-0.148339	,
-0.088669	,
-0.028177	,
0.049068	,
0.118697	,
0.172834	,
0.217421	,
0.250998	,
0.261616	,
0.262455	,
0.246196	,
0.217929	,
0.183055	,
0.132683	,
0.082974	,
0.026204	,
-0.035015	,
-0.083741	,
-0.11573	,
-0.14533	,
-0.15673	,
-0.153357	,
-0.141745	,
-0.115719	,
-0.078042	,
-0.030861	,
0.013957	,
0.055817	,
0.102889	,
0.137508	,
0.170799	,
0.187711	,
0.20819	,
0.212361	,
0.205411	,
0.185843	,
0.159216	,
0.113622	,
0.064972	,
0.024918	,
-0.00598	,
-0.036338	,
-0.063867	,
-0.072938	,
-0.091836	,
-0.101822	,
-0.100087	,
-0.096296	,
-0.081186	,
-0.062958	,
-0.041594	,
-0.02032	,
0.009122	,
0.053867	,
0.099728	,
0.137054	,
0.158477	,
0.17436	,
0.183812	,
0.186113	,
0.180376	,
0.160724	,
0.134616	,
0.101343	,
0.067432	,
0.026409	,
-0.016444	,
-0.066636	,
-0.106457	,
-0.14161	,
-0.153083	,
-0.154038	,
-0.153665	,
-0.127477	,
-0.111193	,
-0.075276	,
-0.022904	,
0.034902	,
0.092895	,
0.162149	,
0.209283	,
0.254393	,
0.281451	,
0.287595	,
0.27346	,
0.237587	,
0.189681	,
0.135259	,
0.066563	,
0.002768	,
-0.06711	,
-0.138333	,
-0.176603	,
-0.204053	,
-0.223018	,
-0.220728	,
-0.196683	,
-0.151083	,
-0.10202	,
-0.03414	,
0.040345	,
0.115442	,
0.181502	,
0.239043	,
0.267817	,
0.296825	,
0.290613	,
0.267263	,
0.227034	,
0.176044	,
0.109769	,
0.03947	,
-0.020404	,
-0.073008	,
-0.124406	,
-0.161875	,
-0.18638	,
-0.190722	,
-0.174941	,
-0.14491	,
-0.098201	,
-0.04798	,
0.023165	,
0.0886	,
0.141171	,
0.181315	,
0.217029	,
0.221268	,
0.226321	,
0.214945	,
0.190264	,
0.151557	,
0.103369	,
0.051708	,
-0.005351	,
-0.051772	,
-0.079253	,
-0.110367	,
-0.113701	,
-0.114447	,
-0.107395	,
-0.099557	,
-0.06508	,
-0.021684	,
0.017292	,
0.05812	,
0.097196	,
0.12579	,
0.14988	,
0.163118	,
0.154456	,
0.137185	,
0.138812	,
0.117645	,
0.100375	,
0.077108	,
0.054722	,
0.023805	,
0.000997	,
-0.017583	,
-0.022977	,
-0.031551	,
-0.031991	,
-0.024931	,
-0.014137	,
-0.008529	,
0.002132	,
0.006591	,
0.01575	,
0.024523	,
0.03201	,
0.037488	,
0.043255	,
0.05241	,
0.060669	,
0.068075	,
0.074584	,
0.075512	,
0.082335	,
0.088053	,
0.096311	,
0.113574	,
0.110159	,
0.096129	,
0.083135	,
0.058404	,
0.02608	,
-0.005745	,
-0.036065	,
-0.060001	,
-0.076974	,
-0.082626	,
-0.074064	,
-0.060831	,
-0.032474	,
0.004247	,
0.044741	,
0.091876	,
0.139031	,
0.178755	,
0.215147	,
0.242767	,
0.254062	,
0.24758	,
0.220966	,
0.175134	,
0.12596	,
0.064711	,
0.001384	,
-0.061053	,
-0.103565	,
-0.153367	,
-0.176882	,
-0.178852	,
-0.163227	,
-0.135871	,
-0.088703	,
-0.0276	,
0.029325	,
0.092466	,
0.142065	,
0.192971	,
0.228932	,
0.244497	,
0.257573	,
0.254959	,
0.235537	,
0.197647	,
0.151595	,
0.084896	,
0.022461	,
-0.038188	,
-0.087749	,
-0.127717	,
-0.147622	,
-0.154812	,
-0.15724	,
-0.131109	,
-0.094682	,
-0.043204	,
0.001953	,
0.062541	,
0.135141	,
0.191186	,
0.232086	,
0.259511	,
0.264262	,
0.257729	,
0.226094	,
0.195909	,
0.147509	,
0.087241	,
0.031236	,
-0.014081	,
-0.057794	,
-0.100985	,
-0.126091	,
-0.140386	,
-0.132986	,
-0.112755	,
-0.090828	,
-0.061954	,
-0.005743	,
0.041075	,
0.089205	,
0.135086	,
0.177423	,
0.198365	,
0.205937	,
0.207862	,
0.202153	,
0.17667	,
0.149765	,
0.124958	,
0.079467	,
0.031471	,
-0.002912	,
-0.029849	,
-0.053626	,
-0.060629	,
-0.070025	,
-0.052762	,
-0.039395	,
-0.018234	,
0.00952	,
0.037819	,
0.050365	,
0.058672	,
0.070986	,
0.072732	,
0.066108	,
0.063073	,
0.05317	,
0.050693	,
0.05092	,
0.068192	,
0.0829	,
0.103165	,
0.102911	,
0.108136	,
0.115569	,
0.125023	,
0.128805	,
0.120477	,
0.108408	,
0.08975	,
0.067062	,
0.031631	,
0.004514	,
-0.007265	,
-0.031596	,
-0.046072	,
-0.049368	,
-0.055894	,
-0.040794	,
-0.020177	,
-0.004723	,
0.025349	,
0.060253	,
0.094654	,
0.135239	,
0.175215	,
0.209342	,
0.228294	,
0.221625	,
0.202841	,
0.178552	,
0.131624	,
0.07694	,
0.031979	,
-0.019418	,
-0.052676	,
-0.080414	,
-0.114286	,
-0.12163	,
-0.126967	,
-0.104823	,
-0.063815	,
-0.015169	,
0.039204	,
0.100313	,
0.16173	,
0.212635	,
0.25689	,
0.290124	,
0.298072	,
0.29503	,
0.264811	,
0.218482	,
0.165342	,
0.10888	,
0.047419	,
-0.014196	,
-0.074413	,
-0.111182	,
-0.133128	,
-0.130703	,
-0.118345	,
-0.083173	,
-0.042618	,
0.014677	,
0.076886	,
0.133687	,
0.19222	,
0.234996	,
0.263797	,
0.271897	,
0.265569	,
0.250566	,
0.230544	,
0.18602	,
0.137934	,
0.099796	,
0.0461	,
-0.001034	,
-0.029453	,
-0.050233	,
-0.061466	,
-0.068841	,
-0.059969	,
-0.031903	,
0.007267	,
0.064875	,
0.112995	,
0.153009	,
0.199094	,
0.222888	,
0.234144	,
0.232641	,
0.219637	,
0.201005	,
0.173781	,
0.131774	,
0.077945	,
0.038846	,
0.011324	,
-0.014828	,
-0.034736	,
-0.044718	,
-0.041794	,
-0.020617	,
0.013326	,
0.045696	,
0.082667	,
0.120839	,
0.150391	,
0.179058	,
0.180013	,
0.186093	,
0.185412	,
0.167776	,
0.150398	,
0.118809	,
0.086979	,
0.046567	,
0.021863	,
0.007798	,
-0.010528	,
-0.003119	,
0.01686	,
0.039164	,
0.065292	,
0.094925	,
0.127484	,
0.151551	,
0.174861	,
0.176106	,
0.168948	,
0.149383	,
0.138454	,
0.121921	,
0.104872	,
0.0769	,
0.053487	,
0.040248	,
0.031564	,
0.040612	,
0.051042	,
0.05923	,
0.078808	,
0.102468	,
0.12163	,
0.143769	,
0.163905	,
0.172985	,
0.169002	,
0.158908	,
0.132824	,
0.105095	,
0.081351	,
0.059548	,
0.056409	,
0.038813
]).


qbo15([
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
10	,
-60	,
-100	,
-160	,
-210	,
-220	,
-240	,
-260	,
-260	,
-255	,
-250	,
-245	,
-240	,
-235	,
-230	,
-220	,
-210	,
-120	,
-40	,
60	,
110	,
130	,
155	,
160	,
155	,
160	,
165	,
170	,
155	,
140	,
120	,
75	,
5	,
70	,
-130	,
-220	,
-280	,
-283	,
-302	,
-280	,
-260	,
-280	,
-235	,
-120	,
15	,
50	,
135	,
115	,
38	,
60	,
85	,
175	,
130	,
23	,
2	,
-2	,
-5	,
-20	,
-70	,
-190	,
-210	,
-220	,
-202	,
-230	,
-247	,
-256	,
-235	,
-245	,
-265	,
-258	,
-124	,
-78	,
-54	,
2	,
26	,
92	,
152	,
189	,
281	,
197	,
130	,
112	,
50	,
-48	,
-74	,
-90	,
-110	,
-160	,
-180	,
-220	,
-247	,
-190	,
-18	,
88	,
146	,
116	,
110	,
110	,
150	,
177	,
199	,
174	,
143	,
69	,
19	,
-29	,
-122	,
-220	,
-246	,
-267	,
-297	,
-294	,
-307	,
-322	,
-322	,
-312	,
-323	,
-289	,
-236	,
-91	,
-165	,
-267	,
-206	,
-71	,
52	,
137	,
218	,
168	,
156	,
115	,
68	,
28	,
-60	,
-151	,
-111	,
-153	,
-236	,
-269	,
-275	,
-296	,
-330	,
-327	,
-337	,
-348	,
-336	,
-338	,
-338	,
-367	,
-353	,
-344	,
-336	,
-357	,
-379	,
-253	,
-10	,
18	,
72	,
70	,
133	,
119	,
150	,
165	,
149	,
116	,
108	,
34	,
7	,
-65	,
-90	,
-138	,
-180	,
-202	,
-225	,
-260	,
-305	,
-320	,
-333	,
-340	,
-325	,
-316	,
-325	,
-328	,
-330	,
-363	,
-261	,
-138	,
13	,
152	,
125	,
171	,
192	,
209	,
167	,
116	,
158	,
159	,
175	,
160	,
156	,
131	,
86	,
-13	,
-134	,
-184	,
-208	,
-224	,
-223	,
-229	,
-234	,
-252	,
-162	,
-101	,
-24	,
115	,
122	,
188	,
175	,
148	,
163	,
173	,
169	,
147	,
160	,
104	,
62	,
56	,
-61	,
-140	,
-203	,
-222	,
-271	,
-264	,
-276	,
-277	,
-285	,
-270	,
-250	,
-80	,
110	,
160	,
105	,
70	,
60	,
65	,
80	,
40	,
-20	,
-95	,
-160	,
-205	,
-230	,
-250	,
-275	,
-303	,
-335	,
-345	,
-335	,
-105	,
-315	,
-305	,
-240	,
-90	,
80	,
140	,
155	,
150	,
145	,
165	,
189	,
180	,
160	,
145	,
138	,
120	,
109	,
98	,
60	,
65	,
30	,
-100	,
-230	,
-260	,
-285	,
-275	,
-265	,
-257	,
-257	,
-256	,
-270	,
-285	,
-305	,
-260	,
-125	,
25	,
105	,
120	,
135	,
160	,
180	,
207	,
204	,
155	,
120	,
80	,
-85	,
-209	,
-235	,
-304	,
-314	,
-325	,
-272	,
-290	,
-324	,
-335	,
-342	,
-330	,
-320	,
-275	,
-220	,
-180	,
-114	,
30	,
98	,
102	,
126	,
106	,
116	,
147	,
175	,
173	,
100	,
60	,
25	,
20	,
-44	,
-75	,
-105	,
-131	,
-195	,
-250	,
-255	,
-232	,
-230	,
-235	,
-238	,
-252	,
-259	,
-248	,
-232	,
-239	,
-233	,
-168	,
-16	,
100	,
116	,
175	,
191	,
165	,
188	,
167	,
121	,
90	,
10	,
-54	,
-200	,
-278	,
-307	,
-320	,
-348	,
-341	,
-342	,
-356	,
-378	,
-355	,
-352	,
-353	,
-349	,
-179	,
-49	,
47	,
96	,
110	,
158	,
222	,
196	,
136	,
175	,
192	,
195	,
139	,
98	,
82	,
71	,
-15	,
-128	,
-242	,
-276	,
-237	,
-293	,
-322	,
-323	,
-330	,
-335	,
-355	,
-355	,
-344	,
-350	,
-364	,
-374	,
-356	,
-331	,
-350	,
-45	,
60	,
108	,
145	,
145	,
139	,
147	,
106	,
101	,
5	,
-158	,
-215	,
-281	,
-274	,
-309	,
-372	,
-373	,
-371	,
-334	,
-335	,
-353	,
-339	,
-359	,
-353	,
-347	,
-367	,
-346	,
-91	,
-76	,
12	,
73	,
218	,
173	,
192	,
212	,
181	,
120	,
130	,
82	,
108	,
129	,
103	,
14	,
-107	,
-159	,
-157	,
-193	,
-240	,
-260	,
-300	,
-310	,
-293	,
-278	,
-288	,
-235	,
-40	,
-33	,
-15	,
3	,
78	,
110	,
115	,
90	,
171	,
176	,
162	,
194	,
184	,
171	,
214	,
201	,
124	,
-158	,
-291	,
-316	,
-316	,
-326	,
-340	,
-344	,
-327	,
-315	,
-313	,
-334	,
-352	,
-364	,
-262	,
-38	,
72	,
144	,
143	,
178	,
199	,
183	,
79	,
63	,
107	,
36	,
-127	,
-195	,
-211	,
-209	,
-216	,
-195	,
-208	,
-267	,
-279	,
-286	,
-331	,
-369	,
-360	,
-318	,
-193	,
23	,
102	,
199	,
208	,
176	,
170	,
186	,
194	,
169	,
164	,
92	,
73	,
78	,
-20	,
-101	,
-132	,
-192	,
-250	,
-270	,
-306	,
-334	,
-342	,
-195	,
30	,
106	,
125	,
204	,
214	,
137	,
219	,
116	,
162	,
100	,
52	,
-5	,
-3	,
-23	,
-144	,
-204	,
-237	,
-270	,
-301	,
-337	,
-348	,
-361	,
-384	,
-374	,
-386	,
-387	,
-369	,
-381	,
-358	,
-327	,
-361	,
-358	,
-282	,
-46	,
21	,
89	,
77	,
97	,
132	,
162	,
224	,
210	,
199	,
229	,
147	,
103	,
2	,
-12	,
-21	,
7	,
-93	,
-175	,
-151	,
-203	,
-288	,
-335	,
-339	,
-332	,
-315	,
-75	,
53	,
87	,
92	,
158	,
242	,
225	,
143	,
170	,
147	,
132	,
107	,
94	,
31	,
-60	,
-137	,
-202	,
-246	,
-283	,
-308	,
-340	,
-341	,
-343	,
-356	,
-353	,
-362	,
-334	,
-76	,
106	,
195	,
165	,
152	,
166	,
94	,
132	,
132	,
114	,
62	,
73	,
-7	,
-139	,
-206	,
-266	,
-296	,
-317	,
-321	,
-320	,
-330	,
-329	,
-245	,
-70	,
42	,
115	,
192	,
171	,
170	,
181	,
145	,
102	,
123	,
92	,
41	,
34	,
-105	,
-189	,
-245	,
-251	,
-248	,
-260	,
-300	,
-330	,
-345	,
-371	,
-366	,
-369	,
-391	,
-373	,
-375	,
-362	,
-347	,
-332	,
-342	,
-236	,
59	,
140	,
150	,
153	,
140	,
147	,
39	,
-44	,
-13	,
-69	,
-208	,
-286	,
-325	,
-336	,
-370	,
-375	,
-358	,
-346	,
-320	,
-356	,
-348	,
-330	,
-333	,
-287	,
-44	,
27	,
83	,
88	,
102	,
133	,
202	,
173	,
169	,
194	,
158	,
132	,
151	,
121	,
122	,
148	,
116	,
77	,
-51	,
-75	,
-111	,
-167	,
-271	,
-288	,
-293	,
-304	,
-318	,
-319	,
-321	,
-329	,
-158	,
-92	,
58	,
82	,
87	,
110	,
125	,
159	,
165	,
207	,
121
]).

qbo30([
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
220	,
210	,
190	,
140	,
110	,
80	,
70	,
50	,
28	,
10	,
-15	,
-60	,
-110	,
-250	,
-200	,
-220	,
-235	,
-230	,
-245	,
-250	,
-185	,
-100	,
60	,
75	,
105	,
108	,
105	,
145	,
190	,
185	,
190	,
211	,
180	,
163	,
66	,
59	,
-22	,
-62	,
-112	,
-224	,
-222	,
-252	,
-249	,
-266	,
-282	,
-276	,
-246	,
-84	,
-21	,
-13	,
92	,
120	,
137	,
141	,
147	,
160	,
180	,
144	,
117	,
110	,
60	,
49	,
37	,
-63	,
-197	,
-204	,
-233	,
-257	,
-277	,
-304	,
-337	,
-330	,
-267	,
-258	,
-255	,
-217	,
-60	,
135	,
207	,
193	,
190	,
127	,
83	,
40	,
-2	,
-18	,
-46	,
-124	,
-182	,
-252	,
-260	,
-256	,
-255	,
-249	,
-208	,
-155	,
-13	,
29	,
38	,
114	,
142	,
181	,
140	,
126	,
89	,
98	,
125	,
69	,
55	,
69	,
49	,
-27	,
-161	,
-228	,
-252	,
-275	,
-280	,
-311	,
-302	,
-292	,
-282	,
-333	,
-346	,
-328	,
-317	,
-215	,
-15	,
36	,
85	,
65	,
70	,
70	,
35	,
-14	,
54	,
64	,
68	,
61	,
27	,
37	,
20	,
32	,
15	,
19	,
7	,
-12	,
-37	,
-157	,
-242	,
-268	,
-287	,
-291	,
-321	,
-319	,
-344	,
-329	,
-302	,
-207	,
-70	,
57	,
136	,
160	,
148	,
153	,
182	,
160	,
144	,
148	,
148	,
145	,
105	,
101	,
53	,
-60	,
-165	,
-150	,
-166	,
-159	,
-197	,
-249	,
-196	,
-208	,
-253	,
-258	,
-232	,
-265	,
-314	,
-308	,
-319	,
-313	,
-207	,
-138	,
4	,
61	,
104	,
151	,
151	,
140	,
151	,
138	,
104	,
88	,
3	,
-54	,
-96	,
-147	,
-166	,
-229	,
-258	,
-294	,
-290	,
-306	,
-327	,
-329	,
-312	,
-189	,
-32	,
45	,
102	,
118	,
132	,
135	,
200	,
160	,
122	,
134	,
125	,
112	,
95	,
74	,
83	,
40	,
-187	,
-231	,
-246	,
-250	,
-273	,
-269	,
-284	,
-172	,
58	,
117	,
106	,
104	,
138	,
132	,
103	,
98	,
85	,
85	,
45	,
10	,
-14	,
-29	,
-31	,
-129	,
-225	,
-289	,
-282	,
-304	,
-298	,
-288	,
-292	,
-300	,
-305	,
-240	,
-85	,
50	,
93	,
171	,
170	,
153	,
152	,
145	,
150	,
157	,
129	,
124	,
123	,
99	,
30	,
-146	,
-220	,
-248	,
-205	,
-257	,
-230	,
-257	,
-270	,
-268	,
-275	,
-285	,
-280	,
-266	,
-140	,
-91	,
44	,
88	,
120	,
170	,
185	,
149	,
128	,
114	,
115	,
100	,
85	,
75	,
93	,
55	,
48	,
20	,
37	,
65	,
-75	,
-147	,
-236	,
-256	,
-264	,
-284	,
-274	,
-280	,
-271	,
-155	,
27	,
34	,
94	,
117	,
124	,
153	,
159	,
151	,
131	,
125	,
107	,
111	,
101	,
91	,
79	,
60	,
-136	,
-241	,
-269	,
-278	,
-281	,
-295	,
-289	,
-302	,
-302	,
-310	,
-316	,
-310	,
-291	,
-283	,
-145	,
72	,
119	,
137	,
117	,
164	,
157	,
151	,
134	,
128	,
108	,
-60	,
-152	,
-177	,
-199	,
-203	,
-252	,
-255	,
-275	,
-283	,
-283	,
-288	,
-321	,
-346	,
-354	,
-340	,
-335	,
-281	,
-22	,
65	,
110	,
87	,
141	,
137	,
139	,
115	,
100	,
85	,
93	,
100	,
102	,
119	,
152	,
148	,
142	,
106	,
-42	,
-194	,
-232	,
-229	,
-234	,
-241	,
-254	,
-267	,
-260	,
-266	,
-271	,
-270	,
-268	,
-247	,
-63	,
92	,
138	,
117	,
77	,
57	,
54	,
46	,
78	,
70	,
50	,
-23	,
-102	,
-63	,
-50	,
-81	,
-101	,
-99	,
-84	,
-40	,
-38	,
-150	,
-250	,
-281	,
-306	,
-300	,
-310	,
-307	,
-306	,
-282	,
-42	,
-32	,
109	,
124	,
124	,
152	,
131	,
135	,
130	,
109	,
110	,
134	,
114	,
127	,
105	,
92	,
-67	,
-209	,
-250	,
-231	,
-215	,
-222	,
-242	,
-253	,
-253	,
-254	,
-260	,
-262	,
-275	,
-268	,
-79	,
8	,
75	,
112	,
141	,
176	,
155	,
164	,
170	,
112	,
108	,
48	,
-10	,
-8	,
-44	,
-111	,
-205	,
-240	,
-251	,
-265	,
-291	,
-298	,
-318	,
-328	,
-338	,
-336	,
-271	,
-9	,
109	,
167	,
178	,
115	,
86	,
110	,
155	,
151	,
125	,
72	,
34	,
-32	,
-131	,
-169	,
-183	,
-202	,
-239	,
-277	,
-307	,
-330	,
-325	,
-346	,
-355	,
-349	,
-284	,
-56	,
22	,
100	,
106	,
151	,
151	,
167	,
141	,
114	,
97	,
75	,
15	,
-49	,
-50	,
-57	,
-127	,
-253	,
-280	,
-297	,
-308	,
-321	,
-311	,
-292	,
-68	,
70	,
99	,
131	,
98	,
140	,
126	,
137	,
111	,
110	,
101	,
91	,
47	,
61	,
74	,
95	,
113	,
61	,
-71	,
-227	,
-282	,
-294	,
-288	,
-275	,
-253	,
-259	,
-284	,
-272	,
-269	,
-309	,
-318	,
-331	,
-349	,
-354	,
-307	,
-136	,
21	,
140	,
118	,
148	,
158	,
129	,
133	,
92	,
103	,
83	,
65	,
41	,
-42	,
-41	,
-14	,
-2	,
-73	,
-194	,
-269	,
-288	,
-313	,
-318	,
-313	,
-312	,
-321	,
-165	,
-16	,
78	,
112	,
126	,
120	,
95	,
90	,
98	,
88	,
73	,
48	,
14	,
-18	,
18	,
-9	,
-178	,
-266	,
-286	,
-309	,
-316	,
-318	,
-320	,
-333	,
-324	,
-288	,
-93	,
83	,
85	,
106	,
123	,
126	,
71	,
109	,
93	,
89	,
73	,
54	,
53	,
14	,
-147	,
-253	,
-297	,
-313	,
-316	,
-321	,
-316	,
-320	,
-265	,
-126	,
38	,
112	,
124	,
124	,
157	,
135	,
118	,
105	,
93	,
75	,
111	,
119	,
155	,
118	,
103	,
32	,
-134	,
-227	,
-218	,
-220	,
-199	,
-252	,
-259	,
-265	,
-272	,
-269	,
-271	,
-263	,
-285	,
-59	,
117	,
134	,
116	,
118	,
83	,
97	,
97	,
101	,
92	,
96	,
70	,
9	,
25	,
-32	,
-75	,
-189	,
-239	,
-238	,
-213	,
-217	,
-257	,
-306	,
-325	,
-326	,
-347	,
-331	,
-336	,
-335	,
-161	,
-47	,
18	,
89	,
102	,
109	,
157	,
147	,
122	,
139	,
119	,
118	,
117	,
148	,
126	,
113	,
88	,
-131	,
-258	,
-307	,
-295	,
-317	,
-323	,
-312	,
-287	,
-278	,
-295	,
-314	,
-311	,
-140	,
75	,
129	,
135	,
162	,
132
]).

qbo70([
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,
-60	,
-2	,
50	,
75	,
95	,
135	,
110	,
75	,
22	,
70	,
125	,
115	,
50	,
1	,
45	,
55	,
60	,
55	,
40	,
25	,
-20	,
-55	,
-80	,
-90	,
-40	,
20	,
55	,
50	,
50	,
45	,
20	,
38	,
70	,
125	,
155	,
110	,
38	,
65	,
90	,
152	,
152	,
95	,
25	,
-8	,
-42	,
-15	,
-5	,
-60	,
-65	,
-75	,
-75	,
-60	,
-50	,
-30	,
-20	,
-5	,
15	,
40	,
40	,
25	,
25	,
20	,
30	,
70	,
85	,
90	,
85	,
80	,
70	,
50	,
30	,
25	,
15	,
-18	,
-45	,
-60	,
-60	,
-65	,
-70	,
-65	,
-20	,
45	,
70	,
75	,
65	,
20	,
50	,
65	,
80	,
85	,
-2	,
-20	,
-40	,
-40	,
-50	,
-95	,
-119	,
-100	,
-92	,
-66	,
-69	,
8	,
43	,
23	,
15	,
27	,
62	,
31	,
54	,
36	,
70	,
101	,
178	,
135	,
133	,
82	,
62	,
80	,
90	,
76	,
19	,
11	,
-11	,
14	,
-32	,
-70	,
-136	,
-177	,
-168	,
-78	,
-4	,
29	,
10	,
0	,
33	,
21	,
63	,
89	,
123	,
88	,
73	,
83	,
109	,
47	,
31	,
60	,
91	,
59	,
147	,
175	,
139	,
90	,
86	,
57	,
-12	,
-82	,
-116	,
-85	,
-70	,
-82	,
-98	,
-85	,
-25	,
-10	,
8	,
82	,
52	,
79	,
83	,
63	,
27	,
91	,
155	,
156	,
153	,
116	,
98	,
87	,
71	,
79	,
35	,
78	,
52	,
47	,
83	,
87	,
73	,
33	,
13	,
34	,
24	,
-10	,
-32	,
-50	,
-71	,
-84	,
-59	,
6	,
89	,
84	,
86	,
95	,
83	,
68	,
69	,
5	,
48	,
22	,
65	,
87	,
74	,
40	,
46	,
9	,
-2	,
-30	,
-42	,
-56	,
-77	,
-78	,
-106	,
-12	,
54	,
60	,
-15	,
14	,
40	,
74	,
50	,
67	,
96	,
116	,
104	,
132	,
90	,
52	,
-4	,
-14	,
-45	,
-114	,
-82	,
-74	,
-115	,
-109	,
-17	,
65	,
69	,
65	,
74	,
84	,
89	,
72	,
64	,
39	,
73	,
79	,
88	,
111	,
101	,
92	,
63	,
32	,
7	,
-39	,
-22	,
-73	,
-76	,
-73	,
-90	,
-78	,
-88	,
-53	,
-19	,
50	,
71	,
37	,
24	,
33	,
51	,
73	,
92	,
85	,
73	,
80	,
62	,
64	,
61	,
40	,
55	,
39	,
30	,
28	,
30	,
-27	,
-80	,
-102	,
-77	,
-78	,
-99	,
-92	,
-48	,
-8	,
4	,
55	,
61	,
69	,
58	,
67	,
68	,
69	,
69	,
68	,
21	,
38	,
44	,
54	,
108	,
107	,
55	,
44	,
17	,
-5	,
-32	,
-99	,
-55	,
-48	,
-82	,
-83	,
-102	,
-92	,
5	,
17	,
30	,
71	,
60	,
50	,
25	,
31	,
54	,
75	,
82	,
96	,
98	,
78	,
64	,
71	,
76	,
39	,
25	,
16	,
36	,
48	,
-57	,
-102	,
-137	,
-133	,
-131	,
-113	,
-80	,
9	,
14	,
24	,
-6	,
8	,
91	,
84	,
77	,
82	,
71	,
73	,
71	,
56	,
45	,
32	,
40	,
49	,
65	,
52	,
-6	,
-45	,
-71	,
-66	,
-73	,
-73	,
-72	,
-67	,
-96	,
-68	,
-6	,
-15	,
46	,
42	,
57	,
68	,
53	,
15	,
21	,
37	,
61	,
53	,
94	,
102	,
86	,
50	,
64	,
95	,
78	,
43	,
57	,
61	,
22	,
-4	,
-2	,
-74	,
-145	,
-148	,
-133	,
-115	,
-37	,
-2	,
7	,
49	,
20	,
19	,
22	,
61	,
60	,
57	,
53	,
54	,
58	,
23	,
68	,
37	,
41	,
67	,
77	,
58	,
42	,
36	,
41	,
3	,
-20	,
3	,
-14	,
-81	,
-31	,
-81	,
-109	,
-50	,
12	,
19	,
32	,
60	,
76	,
56	,
26	,
63	,
52	,
57	,
79	,
71	,
52	,
24	,
34	,
38	,
27	,
36	,
-5	,
47	,
-11	,
26	,
12	,
-32	,
-76	,
-100	,
-90	,
-96	,
-112	,
-105	,
-24	,
-23	,
21	,
55	,
88	,
95	,
57	,
43	,
32	,
71	,
92	,
67	,
51	,
47	,
92	,
83	,
86	,
-14	,
-72	,
-95	,
-120	,
-96	,
-110	,
-70	,
-15	,
-6	,
-40	,
-25	,
41	,
35	,
86	,
87	,
65	,
68	,
47	,
58	,
58	,
65	,
44	,
62	,
71	,
63	,
19	,
-24	,
-23	,
-32	,
-72	,
-31	,
-59	,
-5	,
-87	,
-54	,
-76	,
-24	,
90	,
90	,
95	,
73	,
63	,
33	,
20	,
39	,
29	,
96	,
68	,
30	,
8	,
-12	,
-35	,
-30	,
-87	,
-71	,
-65	,
-78	,
-57	,
-39	,
13	,
44	,
50	,
32	,
35	,
40	,
42	,
32	,
62	,
48	,
46	,
60	,
92	,
106	,
92	,
88	,
76	,
62	,
35	,
-6	,
7	,
22	,
-30	,
17	,
42	,
55	,
-4	,
-54	,
-31	,
-50	,
-39	,
-62	,
-47	,
-62	,
-87	,
9	,
35	,
33	,
10	,
42	,
58	,
88	,
52	,
30	,
31	,
42	,
47	,
19	,
59	,
55	,
40	,
31	,
27	,
34	,
4	,
-9	,
-62	,
-36	,
-58	,
-77	,
-26	,
43	,
39	,
34	,
34	,
65	,
37	,
62	,
4	,
24	,
78	,
29	,
73	,
50	,
44	,
45	,
0	,
-3	,
-16	,
8	,
-14	,
-63	,
-31	,
-72	,
-125	,
-110	,
-24	,
8	,
68	,
76	,
62	,
81	,
41	,
34	,
55	,
91	,
99	,
79	,
21	,
-8	,
12	,
28	,
4	,
-30	,
-65	,
-5	,
-21	,
-49	,
-114	,
-47	,
47	,
35	,
16	,
40	,
23	,
-14	,
-10	,
44	,
36	,
67	,
91	,
95	,
82	,
58	,
69	,
94	,
66	,
64	,
82	,
61	,
49	,
56	,
-56	,
-137	,
-163	,
-163	,
-185	,
-37	,
41	,
44	,
6	,
62	,
48	,
7	,
56	,
33	,
76	,
67	,
109	,
108	,
100	,
54	,
7	,
-1	,
10	,
-7	,
16	,
54	,
12	,
22	,
29	,
37	,
11	,
26	,
-2	,
-1	,
-60	,
-54	,
-128	,
-113	,
-18	,
11	,
60      ,  %
  66    ,
  82	,
  74	,
  62	,
  49	,
  25	,
  82	,
  97	,
  110	,
  110	,
  84	,
  109, 62, 84, 33, -7, 5, -9, -29, -123, -127, -158, -134, -20, 70

]).

temp_data('CW-x', cwx).
temp_data('QBO70', qbo70).
temp_data('QBO30', qbo30).
temp_data('QBO15', qbo15).
temp_data('QBO other', qbo).
temp_data('SOI', soi).
temp_data('Darwin-Tahiti', dt).
temp_data('Tides', sydney).
temp_data('Tides Filtered', sydney2).
temp_data('Tides Biennial Flip', sydney_flip).
temp_data('nino3', nino3).
temp_data('NAO', nao).
temp_data('AMO', amo).
temp_data('GISS', giss).
temp_data('HADCRUT4', hadcrut).
temp_data('BESTLand', best).
temp_data('BEST', best_land_ocean).
temp_data('BEST ER', bester).
temp_data('GISS+HADCRUT4_CW+NOAA', global_combo).
temp_data('HADSST3', sst).
temp_data('CRUTEM4', land).
temp_data('GISSLand', gistemp_dts).
temp_data('BEST+CRUTEM4+GISSLand', land_combo).
temp_data('GISS+NRDC+NOAA', global_combo2).
temp_data('CRUTEM+2*HADSST', composed).
temp_data('NOAA LAND OCEAN', noaa_land_ocean).
temp_data('NOAA LAND', noaa_land).
temp_data('NOAA OCEAN', noaa_ocean).
temp_data('HADCRUT3', hadcrut3).
temp_data('HADSST2', sst2).
temp_data('NCDC', ncdc).
temp_data('HADCRUT4_CW', hadcrut4_cw).
temp_data('OU Random Walk', ou_rw).
temp_data('ER SST', er).

orbital_period('tide precession',  7.3,   'spring tides to realign with calendar date').
orbital_period('tidal cycle',      9.015, 'sun-moon-earth configuration induced oscillation').
orbital_period('lunar standstill', 18.6,  'nodal period when declination of the moon reaches max, Kola cycle').
orbital_period('lunar absidal',    8.85,  'when sidereal period exceeds anomalistic period by one month').
orbital_period('jupiter sidereal', 11.86, 'tidal sidereal period of jupiter').
orbital_period('tidal saros',      18.03, 'Saros cycle period of eclipses of the sun and moon').
orbital_period('lunar harmonic',   6.2,   'one third of the lunar standstill, Kola cycle').
orbital_period('absidal harmonic', 4.42,    'one half lunar absidal').
orbital_period('jupiter harmonic', 5.93,    'one half jupiter sidereal').
% extra

dataset(cwx, CW) :-
    cwx(CW0),
    CW mapdot 100.0 .* CW0.

dataset(ou_rw, RW) :-
    qbo30(L),
    length(L, N),
    Range range [1,N]/1,
    % PL mapdot fake_power_law(1650.0,3) ~> Range,
    context_random_walk:ou_random_walker(0.005,1,0.1,Range,RW), !.
    % L mapdot PL + RW, !.

dataset(giss, L) :- giss(L).
dataset(hadcrut4_cw, L) :-
        hadcrut(L0),
        hadcrut_cw(W),
        Front1 range 1*[1,1188],
        Front0 range 0*[1,1188],
        Change range 0*[1,417],
        % Back1 range 1*[1,5],
        % Back0 range 0*[1,5],
        Mask cat [Front1,Change],
        W_Offset mapdot 0.296 .+ W,
        CW cat [Front0, W_Offset],
        M mapdot Mask * L0,
        L mapdot M + CW.

dataset(hadcrut, L) :- hadcrut(L).
dataset(best, L) :- best(L). %best_land_update(L). %  best(L).
dataset(best_land_ocean, L) :- best_land_ocean(L).
dataset(sst, L) :- sst(L).
dataset(land, L) :- land(L).
dataset(gistemp_dts, L) :- gistemp_dts(L).
dataset(global_combo, L) :-
	dataset(giss,L1),
	dataset(hadcrut4_cw,L2),
	dataset(noaa_land_ocean,L3),
	L mapdot 0.3333 .* L1 + 0.3333 .* L2 + 0.3333 .* L3.
dataset(global_combo2, L) :-
	dataset(giss,L1),
	dataset(ncdc,L2),
	dataset(noaa_land_ocean,L3),
	L mapdot 0.3333 .* L1 + 0.3333 .* L2 + 0.3333 .* L3.
dataset(er, L) :-
	er_sst(L).
dataset(bester, L) :-
	% er_sst(L1),
	dataset(noaa_ocean, L1),
	dataset(best,L2),
	L mapdot 0.72 .* L1 + 0.28 .* L2.

dataset(land_combo, L) :-
	dataset(land,L1),
	dataset(best,L2),
        dataset(gistemp_dts,L3),
	L mapdot 0.3333 .* L1 + 0.3333 .* L2 + 0.3333 .* L3.
dataset(composed, L) :-
	dataset(land,L1),
	dataset(sst,L2),
	L mapdot 0.3 .* L1  +  1.4 .* L2.
dataset(noaa_land_ocean, L) :- noa_land_ocean(L).
dataset(noaa_land, L) :- noa_land(L).
dataset(noaa_ocean, L) :- noa_ocean(L).
dataset(sst2, L) :- hadsst2(L).
dataset(hadcrut3, L) :- hadcrut3(L).
dataset(ncdc, L) :- ncdc(L).
dataset(soi, L) :-
        soi(L0),
	%L1 mapdot abs ~> L0,
	%L2 mapdot sign ~> L0,
	%L3 mapdot sqrt ~> L1,
	%L4 mapdot L2 * L3,
	L unbias L0.
dataset(dt, L) :-
        darwin(D),
        tahiti(T),
	L0 mapdot 0.75 .* D -T,
	% L1 mapdot abs ~> L0,
	% L2 mapdot sign ~> L0,
	% L3 mapdot sqrt ~> L1,
	% L4 mapdot L2 * L3,
	L unbias L0.

add_not_zero(_,[],Initial,Final) :-
   reverse(Initial, Final).
add_not_zero(A,[0|ZR],Initial,Final) :-
   add_not_zero(A,ZR,[0|Initial],Final).
add_not_zero(A,[ZF|ZR],Initial,Final) :-
   Value is A+ZF,
   add_not_zero(A,ZR,[Value|Initial],Final).

list_length(Xs,L) :- list_length(Xs,0,L) .

list_length( []     , L , L ) .
list_length( [0|Xs] , T , L ) :-
  list_length(Xs,T,L).
list_length( [_|Xs] , T , L ) :-
  T1 is T+1 ,
  list_length(Xs,T1,L).

unbias_series(Y, R) :-
   sumlist(Y,N),
   list_length(Y,L),
   Offset is -N/L,
   add_not_zero(Offset, Y, [], R), !.


dataset(qbo15, L) :-
        qbo15(L).
	% L unbias L0.
dataset(qbo30, L) :-
        qbo30(L).
	%      unbias_series(L0,L1),
	%      L accumulate L1.
	%L1 mapdot abs ~> L0,
	%L2 mapdot sign ~> L1,
	%L3 mapdot sqrt ~> L2,
	%L mapdot L0 - 200 .* L3.
	% L unbias L0.
dataset(qbo70, L) :-
        qbo70(L).
	% L1 mapdot abs ~> L0,
	% L2 mapdot sign ~> L0,
	% L3 mapdot sqrt ~> L1,
	%L4 mapdot L2 * L3,
	% L unbias L0.
dataset(qbo, L) :-
        qbo(L0),
	L unbias L0.

dataset(sydney, L) :-
	sydney_tides2(L0),
	L1 unbias L0,
        F window L1*134,
        L mapdot L1 - F.

dataset(sydney2, L) :-
	sydney_tides2(L0),
	L1 unbias L0,
        F window L1*32,
        L mapdot L1 - F.

dataset(sydney_flip, L) :-
	sydney_tides2(L0),
	L1 unbias L0,
        F window L1*32,
        L2 mapdot L1 - F,
        Front range -1*[1,912],
        Back range 1*[913,1607],
        Mask cat [Front,Back],
	L mapdot L2 * Mask.


dataset(nino3, L) :-
        nino3(L0),
	L unbias L0.

dataset(nao, L) :-
        nao(L0),
	L unbias L0.

dataset(amo, L) :-
        amo(L0),
        F window L0*240,
        L1 mapdot L0 - F,
	L unbias L1.


navigate(Request) :-
   collect_unit_options(calendar, Calendar),
   con_text:collect_options(context_chandler_wobble:temp_data, DataSet),
   findall([N,D,P], orbital_period(N,P,D), CycleData),

   reply_html_page(cliopatria(default),
                   [title('QBO model response'),
		    script([type('text/javascript'),src('/html/js/submit.js')], [])
		    % , \(con_text:style)
		   ],
                   [\(con_text:table_with_iframe_target(
                                    Request,
		     [
                      h1('QBO Model'),
                      form([action(plot), target(target_iframe)],
			 [
                           p(['Select data set and a profile view ',
			      input([type('text'),
				 size(4),
				 name('startYear'),
				 value('1953')]),
			      ' : ',
			      input([type('text'),
				 size(4),
				 name('fitYear'),
				 value('2013')])
			     ]),

			  select([name('dataset')], DataSet),
			  % \(con_text:check_box(anthro, 'true', 'anthro aerosols')),
			  % \(con_text:check_box(volc, 'true', 'GISS aerosol model')),
			  input([type('text'),
				 size(2),
				 name('boost'),
				 value('1.0')]),  i(' scale'),
			  \(con_text:check_box(long, 'true', 'ENSO')),

			  br([]),
			  \(con_text:radio_toggles(
					 'evaluate',
					 [
					  ['Match index with model', model],
                                          ['Signal (not used)', signal],
					  ['View the residual error', residual],
					  ['View staggered fluctuation components', all],
					  ['Correlate (not used)', correlate],
					  ['Correlate index with model', map],
					  ['Match natural variability', fluctuation],
					  ['View composite cycles', cycles],
					  ['Dump all component factors', cross]
					  % , ['Cross-Correlate distance vs speed orbital modes ', cross],
					  % ['Show Arctic detrend (arctic_window > 0)', arctic]
                                         ])),
                          br([]),
			  input([type('submit'), name(kind), value('graph'),
                                  onclick('subm(this.form,"target_iframe");')]),
			  input([type('submit'), name(kind), value('table'),
                                  onclick('subm(this.form,"target_iframe");')]),
			  \(con_text:check_box(eq, 'true', 'CC entire range')),
			  \(con_text:check_box(sign, 'true', 'sign metric')),
			  br([]),
                          \(con_text:check_box(second_derivative, 'true', 'Second Deriv')),
			  \(con_text:check_box(fft, 'true', 'FFT of residual')),
			  br([]),
			  \(con_text:check_box(window, 'true', 'Apply 4 month window')),
			  \(con_text:check_box(triple, 'true', 'Pratt filter')),
			  % \(con_text:check_box(lunar, 'true', 'lunar')),

			  br([]),
			  input([type('text'),
				 size(2),
				 name('lag'),
				 value('0')]),
			  select([name('t_units')], Calendar),
			  small(i(' <= lag filter on Match')),

			  small(\multi_columns([
				     div([
					 style([ type('text/css'), scoped ],
					       '@import url("/html/css/context.css")'),
					 table(  %%%%%%%%%%%%%%%  Hard coded  values
				       [
					h2([i('lunar periods'),
					   img([src('/html/images/magnify-clip.png'),
						title('nominal values')
					       ])]),

					\(con_text:input_cells([[days,365.242181,6],
						      [drac,27.21222081,6],
						      [trop,27.32158224,6],
						      [anom,27.554549878,6],
						      [evec,31.8119,6],
                                                      [mfpr,27.266,6],
                                                      [syno,29.53058885,6]
                                                      % [amo_win,-120,2],
						      % [arctic_win, -120,2]
						     ]))
				       ]
					)]),
				     p([' ...... ']),
				     div([style([ type('text/css'), scoped ],
					 '@import url("/html/css/context.css")'),
					  i('number of factors'), br([]),
					  input([type('text'), size(2), name('wave'), value('18')]),
					  \(con_text:check_box(fit_res, 1, 'Mathieu mod')),
					  \(con_text:check_box(high_res, 1, 'high res', checked))
				%	  \(con_text:table_multiple_entries(
				%		  [[cycle, 'period description', year]],
				%		  CycleData
				%				    ))
				 ])
					 ]))
			 ]
			  ),
		      br([]),
		      \(con_text:render_iframe(render))
		     ]
						       ))
		   ]
		  ).

% check_for_nan('$NAN', 0.0) :- !.
% check_for_nan(V, V).


get_fit(StartDate, EndDate, [Temperature, CO2, SOI,  Volc,   LOD,  TSI, AAM,   Arctic, NAO, Sin, Cos,
	                                                          S2,  C2,
	                                                          S3,  C3,
	                                                          S4,  C4,
	                                                          S5,  C5,
	                                                          S6,  C6,
	                                                          S7,  C7,
	                                                          S8,  C8,
	                                                          S9,  C9,
	                                                          SA,  CA,
	                                                          SB,  CB,
	                                                          SC,  CC,
	                                                          SD,  CD,
	                                                          SE,  CE,
	                                                          SF,  CF

								  ],
	[             C,   S,   A,    L,  T, M, Z, N, V, W, P, Q,
		                                E, F, G, H, D, I, R, U,
		                                A1, B1, C1, D1, E1, F1,
		                                G1, H1, I1, J1, K1, L1,
		                                M1, N1, O1, P1, Q1, R1], Int, R2) :-
   % r_open_session,
   y <- Temperature,
   c <- CO2,
   s <- SOI,
   a <- Volc,
   l <- LOD,
   t <- TSI,
   m <- AAM,
   msS <- Arctic,
   msC <- NAO,
   c7S <- Sin,
   c7C <- Cos,
   s9S <- S2,
   s9C <- C2,
   diS <- S3,
   diC <- C3,
   q4S <- S4,
   q4C <- C4,
   qmS <- S5,
   qmC <- C5,
   q1S <- S6,
   q1C <- C6,
   c5S <- S7,
   c5C <- C7,
   cwS <- S8,
   cwC <- C8,
   sdS <- S9,
   sdC <- C9,
   qsS <- SA,
   qsC <- CA,
   spS <- SB,
   spC <- CB,
   q2S <- SC,
   q2C <- CC,
   clS <- SD,
   clC <- CD,
   q3S <- SE,
   q3C <- CE,
   qbS <- SF,
   qbC <- CF,
   % pccr <- princomp('~y+c+s+a+l+t+m+z+j+k+n+v+w+p+q+e+f+g+h+d+i+r+u+a1+b1+c1+d1+e1+f1+g1+h1+i1+j1+k1+l1+m1+n1+o1+p1+q1+r1+s1+t1+u1+v1+w1+x1'),
   % r_print(summary(pccr)),
   % Test <- 'as.double(pccr$coefficients[1])',
   % print(user_error, Test),
   % r_print(loadings(pccr)),
   B is (EndDate - 1900)*20,
   O is (StartDate - 1900)*20 + 1,
   % O = 1, % 840,
   format(atom(Eq), 'y[~d:~d]~~c[~d:~d]+s[~d:~d]+a[~d:~d]+l[~d:~d]+t[~d:~d]+m[~d:~d]+msS[~d:~d]+msC[~d:~d]+c7S[~d:~d]+c7C[~d:~d]+s9S[~d:~d]+s9C[~d:~d]+diS[~d:~d]+diC[~d:~d]+q4S[~d:~d]+q4C[~d:~d]+qmS[~d:~d]+qmC[~d:~d]+q1S[~d:~d]+q1C[~d:~d]+c5S[~d:~d]+c5C[~d:~d]+cwS[~d:~d]+cwC[~d:~d]+sdS[~d:~d]+sdC[~d:~d]+qsS[~d:~d]+qsC[~d:~d]+spS[~d:~d]+spC[~d:~d]+q2S[~d:~d]+q2C[~d:~d]+clS[~d:~d]+clC[~d:~d]+q3S[~d:~d]+q3C[~d:~d]+qbS[~d:~d]+qbC[~d:~d]',
	  [O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,
	   O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,
	   O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,
	   O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,O,B,
	   O,B,O,B,O,B,O,B,O,B]),
   fitxy <- lm(Eq),


   %   Add the variables here !!! don't forget
   % r_print(fitxy),
   Int <- 'as.double(fitxy$coefficients[1])',
   C <- 'as.double(fitxy$coefficients[2])',
   S <- 'as.double(fitxy$coefficients[3])',
   A <- 'as.double(fitxy$coefficients[4])',
   L <- 'as.double(fitxy$coefficients[5])',
   T <- 'as.double(fitxy$coefficients[6])',
   M <- 'as.double(fitxy$coefficients[7])',
   Z <- 'as.double(fitxy$coefficients[8])',
   N <- 'as.double(fitxy$coefficients[9])',
   V <- 'as.double(fitxy$coefficients[10])',
   W <- 'as.double(fitxy$coefficients[11])',
   P <- 'as.double(fitxy$coefficients[12])',
   Q <- 'as.double(fitxy$coefficients[13])',
   E <- 'as.double(fitxy$coefficients[14])',
   F <- 'as.double(fitxy$coefficients[15])',
   G <- 'as.double(fitxy$coefficients[16])',
   H <- 'as.double(fitxy$coefficients[17])',
   D <- 'as.double(fitxy$coefficients[18])',
   I <- 'as.double(fitxy$coefficients[19])',
   R <- 'as.double(fitxy$coefficients[20])',
   U <- 'as.double(fitxy$coefficients[21])',
   A1 <- 'as.double(fitxy$coefficients[22])',
   B1 <- 'as.double(fitxy$coefficients[23])',
   C1  <- 'as.double(fitxy$coefficients[24])',
   D1 <- 'as.double(fitxy$coefficients[25])',
   E1 <- 'as.double(fitxy$coefficients[26])',
   F1 <- 'as.double(fitxy$coefficients[27])',
   G1 <- 'as.double(fitxy$coefficients[28])',
   H1 <- 'as.double(fitxy$coefficients[29])',
   I1 <- 'as.double(fitxy$coefficients[30])',
   J1 <- 'as.double(fitxy$coefficients[31])',
   K1 <- 'as.double(fitxy$coefficients[32])',
   L1 <- 'as.double(fitxy$coefficients[33])',
   M1 <- 'as.double(fitxy$coefficients[34])',
   N1 <- 'as.double(fitxy$coefficients[35])',
   O1 <- 'as.double(fitxy$coefficients[36])',
   P1 <- 'as.double(fitxy$coefficients[37])',
   Q1 <- 'as.double(fitxy$coefficients[38])',
   R1 <- 'as.double(fitxy$coefficients[39])',
/*
   S1 <- 'as.double(fitxy$coefficients[40])',
   T1 <- 'as.double(fitxy$coefficients[41])',
   U1 <- 'as.double(fitxy$coefficients[42])',
   V1 <- 'as.double(fitxy$coefficients[43])',
   W1 <- 'as.double(fitxy$coefficients[44])',
   X1 <- 'as.double(fitxy$coefficients[45])',
   J <- 'as.double(fitxy$coefficients[46])',
   K <- 'as.double(fitxy$coefficients[47])',
   DY <- 'as.double(fitxy$coefficients[48])',
   LM <- 'as.double(fitxy$coefficients[49])',
*/
   summary <- summary(fitxy),
   % r_print(summary),
   R2 <- 'as.double(summary$r.squared)',
   % r_close,
   !.


% scale(_, lin, cross, 'factor a', '#', 'factor b', '#', false) :- !.
scale(_, lin, map, 'Model Temperature', 'C', 'Real Temperature', 'C', false) :- !.
scale(_, lin, correlate, 'TCR*ln(CO2)/ln(2)', 'C', 'Temperature', 'C', false) :- !.
scale(true, log, residual, 'Wavenumber', '2048/Month', 'Power Spectral', 'density', false) :- !.
scale(_, lin, model, 'Time', 'year', 'Index', '#', false) :- !.
scale(_, lin, _, 'Time', 'year', 'Distance', '(a.u.)', false).

single_filter(In, Out) :-
    median_filter(In, In0),
    Out window In0*3.
triple_filter(In, Out) :-
    %median_filter(In, In0),
    % A window In*7, %7 13
    A=In,
    B window A*5, %5 9
    Out window B*3. %3 7

/*
triple_filter(In, Out) :-
    % median_filter(In, In0),
    A window In*7, %7 13
    B window A*5, %5 9
    Out window B*3. %3 7
*/
/*
triple_filter(In, Out) :-
    % median_filter(In, In0),
    A window In*7, %7 13
    B window A*5, %5 9
    Out window B*3. %3 7
*/

% temperature_series(true, true, DataSet, T) :-
%     dataset(DataSet, T0),
%    triple_filter(T0, T1),
%    T window T1*12.

temperature_series(_, true, DataSet, T) :-
    dataset(DataSet, T0),
    triple_filter(T0, T).
temperature_series(true, false, DataSet, T) :-
    dataset(DataSet, T0),
    single_filter(T0, T).
%    uniform(12,Win),
%    T window T0*Win.
temperature_series(false, false, DataSet, T) :-
    dataset(DataSet, T0),
    median_filter(T0, T).

/*
temperature_series(true, DataSet, T) :-
    dataset(DataSet, T0),
    uniform(12,Win),
    T window T0*Win.
temperature_series(false, DataSet, T) :-
    dataset(DataSet, T).
*/

get_fit(1, -1.0).
get_fit(0, 1.0).

% mathieu_modulate(X,Y) :- Y is 1.0-0.5*cos(2*pi*X/17.56-3.0).
mathieu_modulater(Z,X,Y) :- Y is 1.0+Z*0.1*cos(2*pi*X-0.5).
% mathieu_modulater(Z,X,Y) :- Y is
% 1.0+0.4*cos(2*pi*X/6.51-2.0)+0.7*cos(2*pi*X/9.07-1.8).

temperature_series(Second, Window, Triple, DataSet, T, Fit, Offset) :-
   temperature_series(Window, Triple, DataSet, TTT),
   get_fit(Fit, Flip),
   get_years_from_1880(TTT, Year, _),
   TT1 derivative TTT / Year,
   TT2 derivative TT1 / Year,
   TT3 offset TT2 - 1,
   TT4 cat [TT3, [0]],
   TT5 derivative TT4 / Year,
   TT6 derivative TT5 / Year,
   TT7 offset TT6 - 1,
   TT8 cat [TT7, [0]],
   % Omega2 is 1.0,
   Omega2 mapdot -1*mathieu_modulater(0) ~> Year, % 0.8
   Scaled0 mapdot Omega2 * TTT,
       % Offset invert Clip,

   length(Year,L),
   Front range Flip*[1,600],  % 1384 1395 1386
   Back range 1*[601,L],  % 1385 1396 1387
   Clip cat [Front,Back],

   %TTa mapdot TT4 - 0.0 .* TTT, % TT5  %0.041
   %TT mapdot  TTa + 0.0 .* TT8,
   %TT mapdot TTa + TTb,
   % Scaled mapdot Scaled0 + 0*Scal*0.065 .* TT,
   (  Second ->
      TDD mapdot TT4 - 0.036 .* TT5,
      T mapdot TDD + 0.0006 .* TT8
      % T = TT4
   ;
      % TDD mapdot TT4 - 0.042 .* TT5,
      % T mapdot Scaled0 - 0*0.001 .* TDD
      T mapdot Scaled0 * Clip
      % T = Scaled0
   ),
   Offset mapdot 0 .* TT.


get_years_from_1880(T, Years, Zeros) :-
    length(T, L),
    H range [1, L]/1,
    Y mapdot H ./ 20.0,
    Years mapdot 1900 .+ Y,
    Zeros mapdot 0 .* H.

get_months_from_start(T, H) :-
    length(T, L),
    H range [1, L]/1.

is_proper_float(X) :-
catch(_ is X+0.0, _, fail).


check_coefficients([], List, Final ) :- reverse(List, Final), !.
check_coefficients([F|Rest], List, Final ) :-
    % print(user_error, ['v=', F]),
    % F = '$NaN', !, %  '$NaN'
    is_proper_float(F),
    check_coefficients(Rest, [F|List], Final).
% check_coefficients([F|Rest], List, Final ) :-
%    F = 'NA', !,
%    check_coefficients(Rest, [0.0|List], Final).
check_coefficients([_|Rest], List, Final ) :-
    check_coefficients(Rest, [0.0|List], Final).

show_rms([], Out, Out).
show_rms([[Name,A]|R], In, Out) :-
    rms(A, RMS),
    R1000 is 1000*RMS,
    format(atom(Value), '~1f', [R1000]),
    show_rms(R, [[Name,Value]|In], Out).
show_rms(Array, Values) :-
    show_rms(Array, [], Values).

show_equation([], Out, Out).
show_equation([[0.0,0.0,0.0]|R], In, Out) :-
    show_equation(R,In, Out).
show_equation([[Period,S,C]|R], In, Out) :-
    Val is sqrt(S*S+C*C),
    Phase is atan(S,C),
    Per is Period/20.0,
    format(atom(Value), '+ ~14g * sin(2*pi()*$a1/~14g+~14g) ', [Val,Per,Phase]),
    concat(In, Value, Eq),
    show_equation(R,Eq, Out).

show_periods([], Out, Out).
show_periods([[0.0,0.0,0.0]|R], In, Out) :-
    show_periods(R, In, Out).
show_periods([[Period,S,C]|R], In, Out) :-
    RMS is sqrt(S*S+C*C),
    format(atom(Value), '~3f', [RMS]),
    Year is Period / 10,
    % format(atom(Name), '~dyears', [Year]),
    show_periods(R, [[Year,Value]|In], Out).

show_periods(Array, out(Values, Equation)) :-
    show_periods(Array, [], Values),
    show_equation(Array, '', Equation).

html_rms(RMS, _, _) --> {var(RMS)}.
html_rms(RMS, Periodic, Equation) -->
	html(
	    [
	    \(con_text:multi_columns([
		     /* div([
			 p(i('Temperature variance as RMS values in milliKelvin, baseline=1960')),
			 \(con_text:table_multiple_entries([[factor,rms]],RMS))
			 % \(con_text:paragraphs(RMS))
		       ]), */
		     div([
			 % p(i('Individual periodic cycles in years')),
			 \(con_text:table_multiple_entries([[period,rms]],Periodic))
			 % \(con_text:paragraphs(Periodic))
			])
			       ]
				     )
	      ),
	    p(Equation)
	    ]
	    ).    % .

zero_range([], [], Res, Res) :- !.
zero_range([Delta|Tr], [_TD|TDr], Res, U) :-
    abs(Delta) < 1.0e-12,
    !, zero_range(Tr, TDr, [0.0|Res], U).
zero_range([_T|Tr], [TD|TDr], Res, U) :-
    !,zero_range(Tr, TDr, [TD|Res], U).

select_period(false,QBO,_,R,_Add) :- R is QBO*20/2.
select_period(true,_,ENSO,R,1*_) :- R is ENSO*20/2, !.
select_period(true,_,ENSO,R,0*1) :- R is ENSO*20/2, !.
select_period(true,_,ENSO,0.0,0*0).

abcd :- mod_cos_period(1,2,3,4,5).


plot(Request) :-
    http_parameters(Request, [kind(volcanos, [])]),
    context_box_model:volcano_data(Data),
    reply_html_page([title('volcano data'),
                       \(con_text:style)],
                      [
                       \(con_text:table_multiple_entries(
                                      [['eruption',year,month,'month#',intensity, 'VEI']],
                                      Data
                                                        ))
                      ]
                     ).

plot(Request) :-
    garbage_collect,
    http_parameters(Request, [kind(Kind, []),
			      long(Long, [boolean, default(false)]),
			      fft(FFT, [boolean, default(false)]),
			      window(Window, [boolean, default(false)]),
			      triple(Triple, [boolean, default(false)]),
			      boost(Boost, [float, default(1)]),
			      eq(EQ_ON, [boolean, default(false)]),
			      second_derivative(Second, [boolean, default(false)]),
			      sign(SignMetric, [boolean, default(false)]),
			      wave(WL, [integer, default(0)]),
			      fit_res(Fit, [integer, default(0)]),
			      high_res(Add, [integer, default(0)]),
			      t_units(Cal, []),
			      startYear(StartYear, [integer]),
			      fitYear(FitYear, [integer]),
			      lag(LagCal, [float]),
			      days(Days, [float]),
			      drac(Draconic, [float]),
			      trop(Tropical, [float]),
			      anom(Anomalistic, [float]),
			      mfpr(MfPrime, [float]),
			      evec(Evectional, [float]),
			      syno(Synodical, [float]),
			      % amo_win(NL, [number]),
			      % arctic_win(AW, [number]),
                              dataset(DataSet, []),
                              evaluate(Characteristic, [default(model)])]),

    scale(FFT, LogLin, Characteristic, XLabel, XUnits, YLabel, YUnits, Show_Error_Bars),
    scaling(Cal, month, Scale),
    Lag is Scale*LagCal,

    % Get the temperature series
    % FitF is 1.0*Fit,
    temperature_series(Second, Window, Triple, DataSet, T, Fit, Correction),
    % temperature_series(Second, false, false, DataSet, T, Fit, Correction),

    get_years_from_1880(T, Year, Zeros),


    get_months_from_start(T, Months),

    Q is 1.0,
    Sc is 0.995+0.005,
/*
    Days is 365.242181*1.0001, % *0.9994, % 1.0004
    Draconic = 27.21222081,
    Tropical = 27.32158224,
    Anomalistic = 27.554549878,
    Evectional = 31.8119,
    MfPrime is 13.633*2,
    Synodical is 29.53058885,
*/
    Drac is 1/(1/Draconic*Days - 13),
    % Drac is 2.359097,  % 2.37
    Drac1 is 1/(1/Drac + 1),  % 0.7
    Drac2 is 1/(1/Drac + 2),  % 0.41
    Drac3 is 1/(1/Drac + 3),  % 0.29
    DracFour is 1/(1/Drac + 4),  % 0.222
    % Drac5 is 1/(1/Drac + 5),  % 0.184
    Trop is 1/(1/Tropical*Days - 13), %    Trop is 2.711, % 2.715
    Trop1 is 1/(1/Trop + 1),  % 0.7
    MfP is 1/(1/MfPrime*Days - 13), %    Trop is 2.711, % 2.715
    MfP2 is 1/(1/MfP + 1),  % 0.7
    Evec is 1/(1/Evectional*Days - 11),
    Synod is -1/(1/Synodical*Days - 13),
    SynodHalf is 1/(2/Synodical*Days - 2*12),
    AnomHalf is 1/(2/Anomalistic*Days - 2*13),
    Anom is 1/(1/Anomalistic*Days - 14),
    Anom1 is 1/(1/Anom + 1),  % 0.7
    Anom2 is 1/(1/Anom + 2),  % 0.7
    Drac4 is Anom2, % 0.7967, %  Anom2, % 0.7967,  % 0.222

    % P  is Sc*Drac*12, % 2.351 *2*pi/2.6532*12, %  27.21 draconic 2.6532
    Drac_F is Draconic/Days,
    select_period(Long, Drac, Drac, Period,1*Add),
    % Period2 is Sc*Trop*12, %2*pi/2.3157*12, %  27.32 tropical
    select_period(Long, 2.0, Trop, Period2,1*Add),
    % Period3 is Sc*Drac1*12, % 0.701 4.15 3.0243*12, %  27.093 also  31.81 evection
    select_period(Long, Trop, Drac1, Period3,1*Add),
    % Period4 is Sc*Drac2*12, % 0.4129 1.73 3.53 Add*Hale/1 *12 *Q,
    select_period(Long, MfP, Drac2, Period4,1*Add), % 18.613
    % Period5 is Sc*Drac3*12, % 0.317 18.6 0.717 2.505 1.93 1.583 0*7.944*12, % 7.944 2.54  Venus 9.315*12*Q,  %
    select_period(Long, 0.8237, 0.824, Period5,0*Add), % Drac3 4.06
/*
    A1 is 2*pi/2.701,
    A2 is 2*pi/2.592,
    A3 is 2*pi/2.628,
    A4 is 2*pi/2.983,
    A5 is 9.07, % 2*pi/0.692,

    select_period(Long, Drac, A1, Period,1*Add),
    select_period(Long, Trop, A2, Period2,1*Add),
    select_period(Long, Drac1, A3, Period3,1*Add),
    select_period(Long, Drac2, A4, Period4,1*Add), % 18.613
    select_period(Long, Drac3, A5, Period5,0*Add), % 4.06
*/

    % Period6 is Sc*Drac4*12, % 0.222 1.583 9.3 2*pi/1.6055*12, %  27.55 weak
    select_period(Long, Anom2, 2.634, Period6,1*Add), % Anom2 6.65
    % Period7 is Sc*Drac5*12,  % 0.1825 1.35777 18.6 2*pi/1.266993*12, %  27.67 weak
    Short_Year is 354.3671/Days,
    select_period(Long, MfP2, MfP2, Period7,1*Add), % 9.3067

    % Period8 is -Anom*12, % 1.344  2*pi/2.475*12 27.555 anomalistic
    select_period(Long, -Anom, -Anom, Period8,1*Add), %3.64
    % Period9 is Evec*12,       % 2.094 14.77 spin-orbit
    select_period(Long, Evec, Evec, Period9,1*Add), %3.64

    %PeriodA is 2.975*12, % Hale/6 *12 *Q,
    ThreeSyn is Synodical*3.0/Days,
    select_period(Long, ThreeSyn, 2.96, PeriodA,1*Add), % 1.818 2.975 0.4032 0.711   0.24253
    % PeriodB is AnomHalf*12, % 1.954 12*31.786/365.242, 1.965*12, 2*pi/3.0255*12, %  31.81 evection
    select_period(Long, AnomHalf, AnomHalf, PeriodB,1*Add), % AnomHalf 42.66, 8.8512
    % PeriodC is MfP*12, % 2.528 Sc*8.848*12/2, % 1.7579*12, %  1305.48  somewhat weak
    select_period(Long, Drac2, MfP, PeriodC,1*Add),

    Year1 is 365.259/Days,
    % PeriodD is Sc*365.259/Days*12, % 1.009  2*pi/2.5054 13.63
    select_period(Long, Year1, Year1, PeriodD,0*Add), % 7.42

    % YearThird is 1.182, % 121.749/Days,
    YearThird is 121.749/Days,
    % PeriodE is Sc*121.749/Days*12, % 23.918 18.6 0.73085554 13.52 0*Hale/2 *12,
    FCN is 1.14*2,
    select_period(Long, FCN, 1.810, PeriodE,0*Add), % YearThird

    (	Fit = 1 ->
        true % PeriodE is Drac5*12 %0.1825 1.35777 2*pi/1.266993*12, %27.67 weak
	;
        true % PeriodE is SynodHalf*12 % 1.35777 0.1825
    ),
    % PeriodF is Add*Trop1*12, % 0.8245 Trop1 18.6 2*pi/1.266993*12, %  27.67 weak
    select_period(Long, Trop1, 2.11, PeriodF,1*Add), %3.53
    % Period7 is Sc*2*pi/1.94405*12, %  27.44
    %PeriodH is Add*Synod*12, % 0.222 1.583, 9.3 2*pi/1.6055*12 %  27.55 weak
    %PeriodH is 0.2428*12, % 0.2427 0.222 1.583, 9.3 2*pi/1.6055*12 %  27.55 weak
    select_period(Long, 0.6666666, 0.666666, PeriodH,0*Add), % 0.528 0.2428 5.695

    Sin mapdot mod_sin_period(Period,1,WL) ~> Months,
    Cos mapdot mod_cos_period(Period,1,WL) ~> Months,
    Sin2 mapdot mod_sin_period(Period2,2,WL) ~> Months,
    Cos2 mapdot mod_cos_period(Period2,2,WL) ~> Months,
    Sin3 mapdot mod_sin_period(Period3,3,WL) ~> Months,
    Cos3 mapdot mod_cos_period(Period3,3,WL) ~> Months,
    Sin4 mapdot mod_sin_period(Period4,4,WL) ~> Months,
    Cos4 mapdot mod_cos_period(Period4,4,WL) ~> Months,
    Sin5 mapdot mod_sin_period(Period5,5,WL) ~> Months,
    Cos5 mapdot mod_cos_period(Period5,5,WL) ~> Months,
    Sin6 mapdot mod_sin_period(Period6,6,WL) ~> Months,
    Cos6 mapdot mod_cos_period(Period6,6,WL) ~> Months,
    Sin7 mapdot mod_sin_period(Period7,7,WL) ~> Months,
    Cos7 mapdot mod_cos_period(Period7,7,WL) ~> Months,
    Sin8 mapdot mod_sin_period(Period8,8 ,WL) ~> Months,
    Cos8 mapdot mod_cos_period(Period8,8 ,WL) ~> Months,
    Sin9 mapdot mod_sin_period(Period9,9 ,WL) ~> Months,
    Cos9 mapdot mod_cos_period(Period9,9 ,WL) ~> Months,
    SinA mapdot mod_sin_period(PeriodA,10,WL) ~> Months,
    CosA mapdot mod_cos_period(PeriodA,10,WL) ~> Months,
    SinB mapdot mod_sin_period(PeriodB,11 ,WL) ~> Months,
    CosB mapdot mod_cos_period(PeriodB,11 ,WL) ~> Months,
    SinC mapdot mod_sin_period(PeriodC,12 ,WL) ~> Months,
    CosC mapdot mod_cos_period(PeriodC,12 ,WL) ~> Months,
    SinD mapdot mod_sin_period(PeriodD,13,WL) ~> Months,
    CosD mapdot mod_cos_period(PeriodD,13,WL) ~> Months,
    SinE mapdot mod_sin_period(PeriodE,14,WL) ~> Months,
    CosE mapdot mod_cos_period(PeriodE,14,WL) ~> Months,
    SinF mapdot mod_sin_period(PeriodF,15,WL) ~> Months,
    CosF mapdot mod_cos_period(PeriodF,15 ,WL) ~> Months,
    Sin0 mapdot mod_sin_period(PeriodH,16,WL) ~> Months,
    Cos0 mapdot mod_cos_period(PeriodH,16,WL) ~> Months,

    Beat_Node is 1/(1/Draconic-1/Tropical)/Days,
    Beat_Anom is 1/(1/Tropical-1/Anomalistic)/Days,

    % Evection is Beat_Anom/4*12, % 2.21175 3.813 4.59 6.48,
    % Evection is 12*1.0,
    BA4 is   Beat_Anom/4, % 2.25
    select_period(Long, BA4, BA4, Evection,1*Add),
    LogCO2 mapdot mod_sin_period(Evection,17,WL) ~> Months,
    S2 mapdot mod_cos_period(Evection,17,WL) ~> Months,

    % CWobble is Beat_Node/8*12,  % 2.32667 1.7579 1.595 1.185*12,
    BN4 is  Beat_Node/8,
    select_period(Long, 0.53,6.01, CWobble,1*Add),  % 0.56372 0.58 0.531
    V1 mapdot mod_sin_period(CWobble,18,WL) ~> Months,
    LOD_F mapdot mod_cos_period(CWobble,18,WL) ~> Months,

    YearHalf is 182.621/Days,
    BA2 is   Beat_Anom*2, % 2.25
    % K1 is 182.621/Days*12, % 2.3347*12, % 5.9935 12*3.79,
    %select_period(Long, YearHalf, 4.2667, K1,0*Add), % 0.08721149897330595
    select_period(Long, 170.0, YearHalf, K1,0*Add), % 0.08721149897330595
    % select_period(Long, YearHalf, Evec, K1), %3.64
    % select_period(Long, YearHalf, 100.0, K1),

    TSI_F mapdot mod_sin_period(K1,0,WL) ~> Months,
    AAM mapdot mod_cos_period(K1,0,WL) ~> Months,
    %AAM mapdot sin_biennial_period ~> Months,
    %LOD_F mapdot cos_biennial_period ~> Months,

    get_fit(StartYear, FitYear, [T, LogCO2, S2,V1, LOD_F,  TSI_F, AAM, Sin0, Cos0, % Arctic, NAO,
	                                                        Sin,  Cos,  Sin2, Cos2,
	                                                        Sin3, Cos3, Sin4, Cos4,
								Sin5, Cos5, Sin6, Cos6,
								Sin7, Cos7, Sin8, Cos8,
	                                                        Sin9, Cos9, SinA, CosA,
	                                                        SinB, CosB, SinC, CosC,
	                                                        SinD, CosD, SinE, CosE,
	                                                        SinF, CosF],
	    Coefficients, Int, _R2C),
	    % [NoiseA, C, SO, TS, VC,   LO],

    check_coefficients(Coefficients, [], [C, SO, VC,   LO,  TS, AA, SW0, CW0, % ARC, NI,
					                           SW,  CW,  SW2, CW2,
					                           SW3, CW3, SW4, CW4,
					                           SW5, CW5, SW6, CW6,
					                           SW7, CW7, SW8, CW8,
					                           SW9, CW9, SWA, CWA,
					                           SWB, CWB, SWC, CWC,
					                           SWD, CWD, SWE, CWE,
					                           SWF, CWF]),

    Fluct mapdot SO .* S2 + VC .* V1 + LO .* LOD_F +  TS .* TSI_F +  AA .* AAM +
                                          + SW0 .* Sin0 + CW0 .* Cos0  % ARC .* Arctic + NI .* NAO
		                           + SW .* Sin + CW .* Cos
		                           + SW2 .* Sin2 + CW2 .* Cos2
		                           + SW3 .* Sin3 + CW3 .* Cos3
		                           + SW4 .* Sin4 + CW4 .* Cos4
		                           + SW5 .* Sin5 + CW5 .* Cos5
		                           + SW6 .* Sin6 + CW6 .* Cos6
		                           + SW7 .* Sin7 + CW7 .* Cos7
		                           + SW8 .* Sin8 + CW8 .* Cos8
		                           + SW9 .* Sin9 + CW9 .* Cos9
		                           + SWA .* SinA + CWA .* CosA
		                           + SWB .* SinB + CWB .* CosB
		                           + SWC .* SinC + CWC .* CosC
		                           + SWD .* SinD + CWD .* CosD
		                           + SWE .* SinE + CWE .* CosE
		                           + SWF .* SinF + CWF .* CosF
					   ,

    T_CO2_R mapdot C .* LogCO2 + Fluct,
    T_R mapdot Int .+ T_CO2_R,
    T_Diff mapdot T - T_R,
    %
    % Drift_Baseline mapdot C .* LogCO2 + LO .* LOD_F,
    % T_From_Baseline mapdot T - Drift_Baseline,
    !,
    sum_of_squares(T, T_R, Sum_of_Sq),
    length(Months, Length_Series),
    Error_Bar is 2*sqrt(Sum_of_Sq/Length_Series),

    % T_lag lag T / Lag,
    T_lag = T,
    Lag1 is 0*Lag,   %%%%%%%%%%%%%%%%%%%%%%%%%%  Lag is smaller on model
    T_R_lag1 lag T_R / Lag1,
    T_R_mod mapdot Boost*yearly_qmod ~> Months,
    T_R_lag mapdot T_R_mod * T_R_lag1,
    (   EQ_ON ->
        T_lag0 = T_lag,
        T_R_lag0 = T_R_lag
    ;
        SY is (StartYear - 1880)*12+1,
        FY is (FitYear - 1880)*12 + 1,
	% Wi is FY - SY,
        RC range [SY,FY]/1,
	% offset
        T_lag00 offset T_lag - SY,
        T_R_lag00 offset T_R_lag - SY,
        T_lag0 shrink T_lag00 / RC,
        T_R_lag0 shrink T_R_lag00 / RC
    ),
    % corrcoeff(T_lag0, T_R_lag0, R2C20),
    (	SignMetric ->
        excursion(T_lag0, T_R_lag0, R2C20)
    ;
	 % median_filter(T_lag0, T_med),
        corrcoeff(T_lag0, T_R_lag0, R2C20)
    ),
    R2C2 is 100.0*R2C20,
    (
       Characteristic = model ->
    /*
          r_open_session,
          r_in( library(dcv) ),
          model <- T_lag,
          data <- T_R_lag,
          r_in('test.RE(Model, data)'),
          r_close,
     */
         %T_lag_low mapdot T_lag .- Error_Bar,
         %T_lag_high mapdot Error_Bar .+ T_lag,
         %T_lags tuple T_lag_low + T_lag + T_lag_high,
         %T_R_lags tuple T_R_lag + T_R_lag + T_R_lag,
         %Corrections tuple Correction + Correction + Correction,
	 % Data group Year + T_lag + T_R_lag, % + Corrections,
	 Data tuple Year + T_lag + T_R_lag, % + Corrections,
         Header = [XLabel, DataSet, model], % , correction]
         RMS = 1.0,
	 show_periods([[Evection,C, SO],
		       [CWobble, VC, LO],  %V1 VC, LOD_F LO,  TSI_F TS, AAM AA
		       [K1, TS, AA],
	               [PeriodH, SW0, CW0],
	               [Period, SW, CW],
		       [Period2, SW2, CW2],
		       [Period3, SW3, CW3],
		       [Period4, SW4, CW4],
		       [Period5, SW5, CW5],
		       [Period6, SW6, CW6],
		       [Period7, SW7, CW7],
		       [Period8, SW8, CW8],
		       [Period9, SW9, CW9],
		       [PeriodA, SWA, CWA],
		       [PeriodB, SWB, CWB],
		       [PeriodC, SWC, CWC],
		       [PeriodD, SWD, CWD],
		       [PeriodE, SWE, CWE],
		       [PeriodF, SWF, CWF]
		        ], out(Periodic, Equation))

     ;
       Characteristic = fluctuation ->
         TCO2 mapdot Int .+ C .* LogCO2,
         TFluct mapdot T_lag - TCO2,
         FF lag Fluct / Lag,
         Data tuple Year + TFluct + FF,
         Header = [XLabel, signal,  variability]
    ;
         Characteristic = map ->
	 Data tuple T_R_lag + T_lag,
         Header = [model, DataSet]
     ;
       Characteristic = cross ->
         S0S2 mapdot SO .* S2,
         TSTSI_F mapdot TS .* TSI_F,
         VCV1 mapdot VC .* V1,
	 LOLOD_F mapdot LO .* LOD_F,
         AAM_D mapdot AA .* AAM,
	 Waves1 mapdot SW .* Sin + CW .* Cos,
	 Waves2 mapdot SW2 .* Sin2 + CW2 .* Cos2,
         Waves3 mapdot SW3 .* Sin3 + CW3 .* Cos3,
         Waves4 mapdot SW4 .* Sin4 + CW4 .* Cos4,
	 Waves5 mapdot SW5 .* Sin5 + CW5 .* Cos5,
         Waves6 mapdot SW6 .* Sin6 + CW6 .* Cos6,
	 Waves7 mapdot SW7 .* Sin7 + CW7 .* Cos7,
         Waves8 mapdot SW8 .* Sin8 + CW8 .* Cos8,
	 Waves9 mapdot SW9 .* Sin9 + CW9 .* Cos9,
	 WavesA mapdot SWA .* SinA + CWA .* CosA,
	 WavesB mapdot SWB .* SinB + CWB .* CosB,
	 WavesC mapdot SWC .* SinC + CWC .* CosC,
	 WavesD mapdot SWD .* SinD + CWD .* CosD,
	 WavesE mapdot SWE .* SinE + CWE .* CosE,
	 WavesF mapdot SWF .* SinF + CWF .* CosF,

	 CO2_Strength mapdot C .* LogCO2,
         Data tuple Year + CO2_Strength + S0S2 + VCV1 + LOLOD_F + TSTSI_F + AAM_D +
	            Waves1 + Waves2 + Waves3 + Waves4 + Waves5 + Waves6 + Waves7 + Waves8 + Waves9 +
		    WavesA + WavesB + WavesC + WavesD + WavesE + WavesF ,
	 Header = [XLabel, co2, soi,   aero,  lod, tsi,	aam, barys, baryc,
		   p_22_3, p_9, p_18_6, p_8_85, p_11_86, p_3_22, p_11_86_2, p_18_6_3, p_8_85_2,
		   p_5_30, p_4_20, p_22_6, p_22_2, p_22_1, p_3_35, p_27, p_2_46, p_2_00, p_9_3]

     ;

       Characteristic = cycles ->
	 Cycle1 mapdot SW .*  Sin +  CW .*  Cos +  SWA .* SinA + CWA .* CosA +
	               SWB .* SinB + CWB .* CosB + SWC .* SinC + CWC .* CosC +
		       SWD .* SinD + CWD .* CosD + SWE .* SinE + CWE .* CosE,
         Cycle2 mapdot SW2 .* Sin2 + CW2 .* Cos2 + SW6 .* Sin6 + CW6 .* Cos6,
	 Cycle3 mapdot SW3 .* Sin3 + CW3 .* Cos3 + SW8 .* Sin8 + CW8 .* Cos8,
	 Cycle4 mapdot SW4 .* Sin4 + CW4 .* Cos4 + SW9 .* Sin9 + CW9 .* Cos9,
         Cycle5 mapdot SW5 .* Sin5 + CW5 .* Cos5 + SW7 .* Sin7 + CW7 .* Cos7,
         Cycle6 mapdot SWF .* SinF + CWF .* CosF,
	 AllCycles mapdot Cycle1 + Cycle2 +Cycle3 +Cycle4 + Cycle5 + Cycle6,
         S0S2 mapdot SO .* S2,
         % TSTSI_F mapdot TS .* TSI_F,
         AAM_D mapdot AA .* AAM,
	 AllNatural mapdot AAM_D + S0S2,
	 Data tuple Year + AllCycles + AllNatural,
         % Header = [XLabel, '22',   '18.03', '18.6',  '8.85',  '11.86', '2']
         Header = [XLabel, 'cycles', 'natural'],
	 corrcoeff(AllCycles, AllNatural, CycleCC),
	 print(user_error, [cycleCC, CycleCC])

     ;
       Characteristic = residual ->
         (   FFT ->
	     zero_range(T, T_Diff, [], T_Diff2),
	     R_FFT fft T_Diff2,
	     Range ordinal R_FFT,
	     Data tuple Range + R_FFT
	 ;
             % T_Base mapdot Int .+ C .* LogCO2 + LO .* LOD_F ,
             % Noise_Level mapdot T - T_Base,
	     % RHV mapdot NI .* NAO,
	     % get_qbo(QBO),
	     % S0S2 mapdot 4*SO .* S2,
	     % LM2 mapdot 4*LM .* LogMethane,
	     %corrcoeff(T_Diff, S0S2, R2C2),
	     % zero_range(T, T_Diff, [], T_Diff2),
	     Data tuple Year + T_Diff % + S0S2 +LM2   %  + Noise_Level
	 ),

         Header = [XLabel, residual, soi_t, soi_d] % , fluctuation]
     ;
       Characteristic = signal ->
         CO2_Signal mapdot Int .+ C .* LogCO2,
         Signal mapdot CO2_Signal + T_Diff,
         % median_filter(Sig, Signal),
         Data tuple Year + Signal + CO2_Signal + Fluct,
         Header = [XLabel, signal,  co2,         fluctuation]
     ;
       Characteristic = correlate ->
         CO2_Signal mapdot Int .+ C .* LogCO2,
         Signal mapdot CO2_Signal + T_Diff,
         Data tuple CO2_Signal + Signal + CO2_Signal,
         Header = [co2, data, log_model]
     ;
       Characteristic = all ->
         TSTSI_F mapdot 9 .+ TS .* TSI_F,
         S0S2 mapdot 8 .+ SO .* S2,
         VCV1 mapdot 7 .+ VC .* V1,
	 LOLOD_F mapdot 5 .+ LO .* LOD_F,
         % Noise_D mapdot NoiseA .* Noise2,
         AAM_D mapdot 4 .+ AA .* AAM,
         % ARCTIC_D mapdot ARC .* Arctic,
         % NAO_D mapdot NI .* NAO,
	 Diurnal mapdot 3 .+ SW3 .* Sin3 + CW3 .* Cos3 +
	                SW8 .* Sin8 + CW8 .* Cos8,
	 SemiDiurnal mapdot 2 .+ SW4 .* Sin4 + CW4 .* Cos4 +
	                    SW9 .* Sin9 + CW9 .* Cos9,
	 % HaleCycle mapdot 0.1 .+ SW .* Sin + CW .* Cos +
	 %               SWC .* SinC + CWC .* CosC +
	 %               SWD .* SinD + CWD .* CosD +
	 %               SWE .* SinE + CWE .* CosE,
	 HaleCycle mapdot 1 .+ SW .* Sin + CW .* Cos +
	                SWA .* SinA + CWA .* CosA +
	                SW5 .* Sin5 + CW5 .* Cos5,
	 % Jupiter mapdot 0.2 .+ SW5 .* Sin5 + CW5 .* Cos5 +
	 %                SW7 .* Sin7 + CW7 .* Cos7,
	 SunMoonEarth  mapdot SW2 .* Sin2 + CW2 .* Cos2,
			 % SWH .* SinH + CWH .* CosH,
	 Cycle_20_80 mapdot -1 .+ SWF .* SinF + CWF .* CosF +
	                SW6 .* Sin6 + CW6 .* Cos6 +
	                SWA .* SinA + CWA .* CosA +
	                SWB .* SinB + CWB .* CosB,

	 Waves mapdot SW .* Sin + CW .* Cos + SW2 .* Sin2 + CW2 .* Cos2
                                              + SW3 .* Sin3 + CW3 .* Cos3
                                              + SW4 .* Sin4 + CW4 .* Cos4
					      + SW5 .* Sin5 + CW5 .* Cos5
                                              + SW6 .* Sin6 + CW6 .* Cos6
					      + SW7 .* Sin7 + CW7 .* Cos7
                                              + SW8 .* Sin8 + CW8 .* Cos8
                                              + SW9 .* Sin9 + CW9 .* Cos9, % Check

	 CO2_Strength mapdot Int .+ C .* LogCO2,
	 % Meth mapdot -0.2 .+ LM .* LogMethane,
	 ResidNoise mapdot -0.3 .+ T_Diff,
	 show_rms([% [amo, NAO_D],
		   % [arctic, ARCTIC_D],
		   ['set of orbital cycles',Waves],
		   [tsi,TSTSI_F],
		   [aero, VCV1],
		   [aam,AAM_D],
		   [soi,S0S2],
		   [lod,LOLOD_F],
		   [co2, CO2_Strength]], RMS),
	 show_periods([[Period, SW, CW],
		       [Period2, SW2, CW2],
		       [Period3, SW3, CW3],
		       [Period4, SW4, CW4],
		       [Period5, SW5, CW5],
		       [Period6, SW6, CW6],
		       [Period7, SW7, CW7],
		       [Period8, SW8, CW8],
		       [Period9, SW9, CW9],
		       [PeriodA, SWA, CWA],
		       [PeriodB, SWB, CWB],
		       [PeriodC, SWC, CWC],
		       [PeriodD, SWD, CWD],
		       [PeriodE, SWE, CWE],
		       [PeriodF, SWF, CWF]
		        ], out(Periodic, Equation)),

     /*
         Angular mapdot AAM_D + LOLOD_F + Y_Lunar,
         Data tuple Year + S0S2 + VCV1 + TSTSI_F + ARCTIC_D + NAO_D + Angular,
	 Header = [XLabel, soi,   aero,  tsi,      arctic,    nao,    angular]
     */
	 % Double mapdot SemiDiurnal + SunMoonEarth,
         Data tuple Year + TSTSI_F + S0S2 + VCV1 + LOLOD_F + AAM_D +
	                   Diurnal %
			   +SemiDiurnal
			   % + Double
			   + HaleCycle % + Jupiter + Venus
			   + SunMoonEarth
			   + Cycle_20_80 + ResidNoise + CO2_Strength, % + Meth,
	 Header = [XLabel, tsi,  soi, aero,      lod,      aam,
		           diurnal, semi, hale, % jupiter, venus,
		           sme,
		           '20/80', residual,co2] % , methane]

    ),
    temp_data(NameData, DataSet),
    TCR is C*ln(2),
    PPP is Period7/12,
    print(user_error, ['random period ', PPP]),

    (	Kind = graph ->
    reply_html_page([title('GISS and SOI'),
                     \(con_text:style)],
                    [
		     table([tr([th('R=cc')        ]),
			    tr([td(b('~5f'-R2C2))      ])
			   ]),

		     table( % [class('fixed')],
			   [caption(div([id('legend')],[])),
			    tr([
				td(
		       \(context_graphing:dygraph_error_bars_base(LogLin, Header,
						       [XLabel,XUnits], [YLabel, YUnits],
						       [NameData, ':', FitYear, ' - lunar:', Characteristic, ' 2nd:', Second ], Data, Show_Error_Bars, 1200))
		     % \(context_graphing:dygraph_native(LogLin, Header,
		%				       [XLabel,XUnits], [YLabel, YUnits],
		%				       [NameData, FitYear, ' - ENSO:', Characteristic], Data))
				  )
			       ])]),
		     br([]),
		     % br([]),
		     % p(i('TCR = ~4f C for doubling of CO2'-TCR)),
		     \html_rms(RMS, Periodic, Equation)
                    ]
		  )
   ;
      reply_html_page([title(Characteristic),
                       \(con_text:style)],
                      [
                       \(con_text:table_multiple_entries(
                                      [Header],
                                      Data
                                                        ))
                      ]
                     )

    ).







